<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>DealBankers — Real Estate Command Hub</title>
<link rel="icon" type="image/jpeg" href="icon (1).jpg"/>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="config.js"></script>
<script src="app-auth.js"></script>

<style>
:root{--bg1:#0a0f15;--accent:#2b74ff;--text:#eaf2ff;--line:#1e2c3a;--muted:#9db2c7;}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg1);color:var(--text);}
header{display:flex;align-items:center;justify-content:space-between;padding:10px 18px;border-bottom:1px solid var(--line);
background:linear-gradient(90deg,#0a0f15,#13233a 80%,#0a0f15);}
.brand{display:flex;align-items:center;gap:10px;font-weight:800}
.brand img{width:40px;height:40px;border-radius:10px}
nav{display:flex;gap:10px}
nav a{padding:6px 14px;border-radius:8px;background:#18283b;font-weight:700;color:#cfe3ff;transition:.2s}
nav a:hover{background:#25538c;color:#fff}
.status{font-size:.8rem;color:var(--muted)}
.hero{text-align:center;padding:70px 20px 50px;}
.hero h1{font-size:2.4rem;margin:0;font-weight:900;color:#fff;}
.hero p{color:#b5cbe0;font-size:1.1rem;margin:0 0 30px}
.section{max-width:1200px;margin:50px auto;padding:0 16px}
.townhall{background:rgba(10,20,30,.9);border-top:1px solid var(--line);padding:20px 0;}
.chat-container{max-width:900px;margin:0 auto;border-radius:14px;background:rgba(15,24,35,.7);
 border:1px solid var(--line);padding:20px;display:flex;flex-direction:column;height:500px;}
.chat-messages{flex:1;overflow-y:auto;padding-right:4px;}
.msg{margin-bottom:10px;padding:10px;border-radius:10px;background:rgba(255,255,255,.04);}
.msg strong{color:#2b74ff}
.msg small{color:#9db2c7;font-size:.7rem;margin-left:4px}
.chat-input{display:flex;gap:10px;margin-top:10px}
.chat-input input{flex:1;padding:10px;border-radius:10px;border:1px solid #294861;background:#0e2332;color:#fff}
.chat-input button{padding:10px 14px;border-radius:10px;border:1px solid #2b74ff;background:#173764;color:#fff;font-weight:700;cursor:pointer}
footer{text-align:center;margin:40px auto;color:#88a5bf;font-size:.9rem;}
footer span{display:block;margin-top:4px;color:#2b74ff;font-weight:700}
</style>
</head>
<body>
<header>
 <div class="brand"><img src="icon (1).jpg" alt=""><span>DealBankers</span></div>
 <nav>
  <a href="#">Home</a>
  <a href="claims-exchange.html">Claims Exchange</a>
  <a href="profile.html">Portal</a>
 </nav>
 <div class="status" id="authStatus">Loading...</div>
</header>

<section class="hero">
 <h1>DealBankers</h1>
 <p>Your One-Stop Real Estate Portal</p>
</section>

<section class="townhall">
 <h2 style="text-align:center;margin-bottom:16px;color:#cfe3ff">Townhall Chat</h2>
 <div class="chat-container">
  <div id="msgs" class="chat-messages"></div>
  <div class="chat-input">
   <input id="msgBox" type="text" placeholder="Say something to the room... (press Enter to send)">
   <button id="sendBtn">Send</button>
  </div>
 </div>
</section>

<footer>
 © <span id="year"></span> DealBankers.com
 <span>Tread Lightly. Carry a Big Stick.</span>
</footer>

<script>
let U=null;
firebase.auth().onAuthStateChanged(u=>{
  const s=document.getElementById('authStatus');
  if(u){U=u; s.textContent='Signed in as '+(u.displayName||u.email); attach();}
  else{s.innerHTML='<a href="login.html" style="color:#2b74ff;">Sign in</a>';}
});

function esc(s){return(''+(s||'')).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]))}
function attach(){
  const ref=firebase.database().ref('townhall/messages').limitToLast(100);
  const list=document.getElementById('msgs');
  ref.on('child_added', s=>{
    const m=s.val()||{}, t=new Date(m.ts||Date.now()).toLocaleString();
    const el=document.createElement('div'); el.className='msg';
    el.innerHTML='<strong>'+esc(m.name||'Anon')+'</strong> <small>'+t+'</small><div>'+esc(m.text||'')+'</div>';
    list.appendChild(el); list.scrollTop=list.scrollHeight;
  });
  const send=()=>{
    const box=document.getElementById('msgBox');
    const txt=(box.value||'').trim();
    if(!txt) return;
    firebase.database().ref('townhall/messages').push({
      uid:U.uid,name:U.displayName||U.email||'Anon',
      text:txt,ts:firebase.database.ServerValue.TIMESTAMP
    }).then(()=>box.value='');
  };
  document.getElementById('sendBtn').onclick=send;
  document.getElementById('msgBox').addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault();send();}});
}
document.getElementById('year').textContent=new Date().getFullYear();
</script>
</body>
</html>
