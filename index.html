<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>DealBankers â€” Real Estate Command Hub</title>
<link rel="icon" type="image/jpeg" href="icon (1).jpg"/>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="config.js"></script>

<style>
:root{
  --bg:#0a0f15;--accent:#2b74ff;--text:#eaf2ff;--line:#1e2c3a;--muted:#9db2c7;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
  background:var(--bg);color:var(--text);overflow-x:hidden;
}
header{
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 18px;border-bottom:1px solid var(--line);
  background:linear-gradient(90deg,#0a0f15,#13233a 80%,#0a0f15);
}
.brand{display:flex;align-items:center;gap:10px;font-weight:800}
.brand img{width:40px;height:40px;border-radius:10px}
nav{display:flex;gap:10px}
nav a{padding:6px 14px;border-radius:8px;background:#18283b;font-weight:700;color:#cfe3ff;transition:.2s}
nav a:hover{background:#25538c;color:#fff}
.status{font-size:.8rem;color:var(--muted)}

main{
  display:grid;grid-template-columns:1.1fr 0.9fr;gap:20px;
  max-width:1200px;margin:40px auto;padding:0 16px;animation:fadeIn .8s ease-in;
}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:none}}

.left-col,.right-col{
  background:rgba(15,24,35,.4);
  border:1px solid var(--line);border-radius:14px;
  padding:24px;
}
.hero{text-align:center;margin-bottom:24px}
.hero h1{font-size:2.2rem;margin-bottom:6px}
.hero p{color:#b5cbe0;margin-bottom:20px}
.gbtn{
  display:inline-flex;align-items:center;justify-content:center;gap:10px;
  padding:12px 20px;border-radius:12px;border:1px solid #747775;
  background:#1f1f1f;color:#e8eaed;font-weight:700;cursor:pointer;font-size:1rem;
}
.gbtn:hover{background:#2c2c2c}
.gbtn img{width:20px;height:20px}

.tiles{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:10px}
.tile{
  background:linear-gradient(180deg,#111b27,#0c1219);
  border:1px solid #1d2b3a;border-radius:16px;
  padding:20px;text-align:center;transition:.3s;cursor:pointer;
}
.tile:hover{transform:translateY(-5px);box-shadow:0 4px 16px rgba(43,116,255,.3)}
.tile h3{margin:6px 0;color:#fff;font-size:1.1rem}
.tile p{font-size:.9rem;color:#9db2c7}

.townhall h2{text-align:center;margin-bottom:12px;color:#cfe3ff}
.chat-container{
  border-radius:14px;background:rgba(15,24,35,.7);
  border:1px solid #1e2c3a;padding:16px;display:flex;flex-direction:column;
  height:480px;
}
.chat-messages{flex:1;overflow-y:auto;padding-right:4px}
.msg{margin-bottom:10px;padding:10px;border-radius:10px;background:rgba(255,255,255,.04)}
.msg strong{color:#2b74ff}
.msg small{color:#9db2c7;font-size:.7rem;margin-left:4px}
.chat-input{display:flex;gap:10px;margin-top:10px}
.chat-input input{flex:1;padding:10px;border-radius:10px;border:1px solid #294861;background:#0e2332;color:#fff}
.chat-input button{padding:10px 14px;border-radius:10px;border:1px solid #2b74ff;background:#173764;color:#fff;font-weight:700;cursor:pointer}
.chat-input button:hover{background:#2b74ff}
footer{text-align:center;margin:40px auto;color:#88a5bf;font-size:.9rem}
footer span{display:block;margin-top:4px;color:#2b74ff;font-weight:700}

@media(max-width:900px){
  main{grid-template-columns:1fr;gap:30px}
  .chat-container{height:400px}
}
</style>
</head>
<body>
<header>
  <div class="brand"><img src="icon (1).jpg" alt=""><span>DealBankers</span></div>
  <nav>
    <a href="#">Home</a>
    <a href="#tools">Tools</a>
    <a href="#townhall">Townhall</a>
    <a href="claims-exchange.html">Claims Exchange</a>
  </nav>
  <div class="status" id="authStatus">Signed out</div>
</header>

<main>
  <div class="left-col">
    <div class="hero">
      <h1>DealBankers</h1>
      <p>Your One-Stop Real Estate Portal</p>
      <button id="googleBtn" class="gbtn">
        <img src="https://developers.google.com/identity/images/g-logo.png" alt=""> Sign in with Google
      </button>
    </div>
    <div id="tools" class="tiles">
      <div class="tile"><h3>Transactional Coordinating</h3><p>Document flow, title coordination, compliance.</p></div>
      <div class="tile"><h3>Property Analysis</h3><p>Valuation tools powered by market data.</p></div>
      <div class="tile"><h3>Skip Tracing</h3><p>Owner & contact lookup services.</p></div>
      <div class="tile"><h3>Wholesalers</h3><p>Upload leads, request campaigns, partnerships.</p></div>
      <div class="tile"><h3>Contractors</h3><p>Claim jobs, request micro-loans, manage tools.</p></div>
      <div class="tile"><h3>Realtors</h3><p>Access training, analysis, and leads.</p></div>
      <div class="tile" style="grid-column:1 / -1;justify-self:center;max-width:240px">
        <h3>Investors</h3><p>Raise & deploy capital, manage notes, post updates.</p>
      </div>
    </div>
  </div>

  <div class="right-col townhall">
    <h2>ðŸ”µ Townhall Chat (Live)</h2>
    <div class="chat-container">
      <div id="messages" class="chat-messages"></div>
      <div class="chat-input">
        <input id="msgInput" type="text" placeholder="Sign in to chat..." disabled>
        <button id="sendBtn" disabled>Send</button>
      </div>
    </div>
  </div>
</main>

<footer>
  Â© <span id="year"></span> DealBankers.com
  <span>Tread Lightly. Carry a Big Stick.</span>
</footer>

<script>
document.getElementById('year').textContent = new Date().getFullYear();

let db, auth, user;
window.addEventListener('load', ()=>{
  if(!firebase.apps.length){
    console.error("Firebase not initialized");
    alert("Firebase config error.");
    return;
  }

  db = firebase.database();
  auth = firebase.auth();

  const googleBtn=document.getElementById('googleBtn');
  const statusEl=document.getElementById('authStatus');
  const msgList=document.getElementById('messages');
  const msgInput=document.getElementById('msgInput');
  const sendBtn=document.getElementById('sendBtn');

  googleBtn.addEventListener('click', async ()=>{
    const provider = new firebase.auth.GoogleAuthProvider();
    try{
      await auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);
      await auth.signInWithPopup(provider);
      window.location.href="profile.html";
    }catch(e){console.error(e);}
  });

  auth.onAuthStateChanged(u=>{
    user=u;
    if(u){
      statusEl.innerHTML = `Signed in as ${u.displayName||u.email} <a id='logout' style='color:#2b74ff;cursor:pointer;margin-left:6px;'>Sign out</a>`;
      document.getElementById('logout').onclick = ()=>auth.signOut();
      msgInput.disabled=false;sendBtn.disabled=false;msgInput.placeholder="Type your message...";
    } else {
      statusEl.textContent='Signed out';
      msgInput.disabled=true;sendBtn.disabled=true;msgInput.placeholder="Sign in to chat...";
    }
    attachChat();
  });

  function esc(s){return(''+(s||'')).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]))}

  function attachChat(){
    const ref = db.ref('townhall/messages').limitToLast(25);
    ref.off();
    msgList.innerHTML='';
    ref.on('child_added', snap=>{
      const d=snap.val()||{};
      const t=new Date(d.ts||Date.now()).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
      const div=document.createElement('div');
      div.className='msg';
      div.innerHTML=`<strong>${esc(d.name||'Anon')}</strong> <small>${t}</small><div>${esc(d.text||'')}</div>`;
      msgList.appendChild(div);
      msgList.scrollTop=msgList.scrollHeight;
    });
  }

  function sendMsg(){
    if(!user){alert('Please sign in first.');return;}
    const text=msgInput.value.trim();
    if(!text)return;
    db.ref('townhall/messages').push({
      uid:user.uid,
      name:user.displayName||user.email,
      text,
      ts:firebase.database.ServerValue.TIMESTAMP
    });
    msgInput.value='';
  }

  sendBtn.onclick=sendMsg;
  msgInput.addEventListener('keypress',e=>{
    if(e.key==='Enter'){e.preventDefault();sendMsg();}
  });
});
</script>
</body>
</html>
