<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>DealBankers ‚Äî Real Estate Command Hub</title>
<link rel="icon" type="image/jpeg" href="icon (1).jpg"/>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="config.js"></script>

<style>
:root {
  --bg1: #0a0f15;
  --accent: #2b74ff;
  --text: #eaf2ff;
  --line: #1e2c3a;
  --muted: #9db2c7;
}
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: Inter, system-ui, Segoe UI, Roboto, Arial;
  background: var(--bg1);
  color: var(--text);
}
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 18px;
  border-bottom: 1px solid var(--line);
  background: linear-gradient(90deg, #0a0f15, #13233a 80%, #0a0f15);
}
.brand {
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 800;
}
.brand img { width: 40px; height: 40px; border-radius: 10px; }
nav { display: flex; gap: 10px; }
nav a {
  padding: 6px 14px;
  border-radius: 8px;
  background: #18283b;
  font-weight: 700;
  color: #cfe3ff;
  transition: 0.2s;
  text-decoration: none;
}
nav a:hover { background: #25538c; color: #fff; }
.status { font-size: 0.8rem; color: var(--muted); }

.hero {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 40px;
  padding: 40px 5%;
  flex-wrap: wrap;
}

.left-column {
  flex: 1.2;
  min-width: 340px;
}
.right-column {
  flex: 1;
  min-width: 340px;
  display: flex;
  flex-direction: column;
  align-items: stretch;
}

h1 {
  font-size: 2rem;
  margin: 0 0 10px;
  font-weight: 900;
  text-align: left;
  color: #fff;
}
h2 {
  font-size: 1.3rem;
  margin: 16px 0 10px;
  color: #cfe3ff;
}
p { color: #9db2c7; font-size: 0.95rem; }

.gbtn {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 10px 18px;
  border-radius: 12px;
  border: 1px solid #747775;
  background: #1f1f1f;
  color: #e8eaed;
  font-weight: 700;
  cursor: pointer;
  font-size: 0.95rem;
  transition: 0.2s;
  margin-top: 8px;
}
.gbtn:hover { background: #2c2c2c; }
.gbtn img { width: 20px; height: 20px; }

.tiles {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 14px;
  margin-top: 10px;
}
.tile {
  background: linear-gradient(180deg, #111b27, #0c1219);
  border: 1px solid #1d2b3a;
  border-radius: 16px;
  padding: 18px;
  text-align: center;
  transition: 0.3s;
  cursor: pointer;
}
.tile:hover {
  transform: translateY(-4px);
  box-shadow: 0 4px 16px rgba(43, 116, 255, 0.3);
}
.tile h3 { margin: 8px 0; color: #fff; font-size: 1rem; }
.tile p { font-size: 0.85rem; color: #9db2c7; }

/* Chat */
.chat-container {
  height: 460px;
  display: flex;
  flex-direction: column;
  border-radius: 14px;
  background: rgba(15, 24, 35, 0.7);
  border: 1px solid #1e2c3a;
  padding: 18px;
}
.chat-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.chat-header h2 {
  margin: 0;
  font-size: 1rem;
}
.chat-messages {
  flex: 1;
  overflow-y: auto;
  padding-right: 4px;
}
.msg {
  margin-bottom: 10px;
  padding: 10px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.04);
}
.msg strong { color: #2b74ff; }
.msg small { color: #9db2c7; font-size: 0.7rem; margin-left: 4px; }
.chat-input {
  display: flex;
  gap: 8px;
  margin-top: 10px;
}
.chat-input input {
  flex: 1;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid #294861;
  background: #0e2332;
  color: #fff;
}
.chat-input button {
  padding: 10px 14px;
  border-radius: 10px;
  border: 1px solid #2b74ff;
  background: #173764;
  color: #fff;
  font-weight: 700;
  cursor: pointer;
}
.chat-input button:hover { background: #2b74ff; }

footer {
  text-align: center;
  margin: 30px auto;
  color: #88a5bf;
  font-size: 0.9rem;
}
footer span {
  display: block;
  margin-top: 4px;
  color: #2b74ff;
  font-weight: 700;
}

@media(max-width: 900px) {
  .hero { flex-direction: column; }
  .left-column, .right-column { width: 100%; }
  h1 { text-align: center; }
}
</style>
</head>
<body>

<header>
  <div class="brand"><img src="icon (1).jpg" alt=""><span>DealBankers</span></div>
  <nav>
    <a href="#">Home</a>
    <a href="#tools">Tools</a>
    <a href="#portals">Portals</a>
    <a href="claims-exchange.html">Claims Exchange</a>
  </nav>
  <div class="status" id="authStatus">Signed out</div>
</header>

<section class="hero">
  <div class="left-column">
    <h1>DealBankers</h1>
    <p>Your One-Stop Real Estate Portal</p>
    <button id="googleBtn" class="gbtn">
      <img src="https://developers.google.com/identity/images/g-logo.png" alt=""> Sign in with Google
    </button>

    <h2>Quick Service Links</h2>
    <div class="tiles">
      <div class="tile"><h3>Transactional Coordinating</h3><p>End-to-end document flow and compliance.</p></div>
      <div class="tile"><h3>Property Analysis</h3><p>Valuation tools powered by market data.</p></div>
      <div class="tile"><h3>Skip Tracing</h3><p>Advanced owner and contact lookup services.</p></div>
    </div>

    <h2 style="margin-top:25px;">User Portals</h2>
    <div class="tiles">
      <div class="tile"><h3>Wholesalers</h3><p>Upload leads and go live for partnerships.</p></div>
      <div class="tile"><h3>Contractors</h3><p>Post jobs, request micro-loans, and manage tools.</p></div>
      <div class="tile"><h3>Realtors</h3><p>Access training and analysis tools.</p></div>
      <div class="tile"><h3>Investors</h3><p>Manage notes and raise capital collaboratively.</p></div>
    </div>
  </div>

  <div class="right-column">
    <div class="chat-container">
      <div class="chat-header"><h2>üèõÔ∏è Townhall Chat</h2></div>
      <div id="messages" class="chat-messages"></div>
      <div class="chat-input">
        <input id="msgInput" type="text" placeholder="Type your message...">
        <button id="sendBtn">Send</button>
      </div>
    </div>
  </div>
</section>

<footer>
  ¬© <span id="year"></span> DealBankers.com
  <span>Tread Lightly. Carry a Big Stick.</span>
</footer>

<script>
document.getElementById('year').textContent = new Date().getFullYear();

let db, auth, user;
window.addEventListener('load', () => {
  if (!firebase.apps.length) {
    alert("Firebase not initialized. Check config.js");
    return;
  }

  db = firebase.database();
  auth = firebase.auth();
  const googleBtn = document.getElementById('googleBtn');
  const statusEl = document.getElementById('authStatus');
  const msgList = document.getElementById('messages');
  const msgInput = document.getElementById('msgInput');
  const sendBtn = document.getElementById('sendBtn');

  googleBtn.addEventListener('click', async () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    try {
      await auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);
      await auth.signInWithPopup(provider);
    } catch (e) { console.error(e); }
  });

  auth.onAuthStateChanged(u => {
    user = u;
    if (u) {
      googleBtn.style.display = 'none';
      statusEl.innerHTML = `Signed in as ${u.displayName || u.email} <a id='logout' style='color:#2b74ff;cursor:pointer;margin-left:6px;'>Sign out</a>`;
      document.getElementById('logout').onclick = () => auth.signOut();
      attachChat(); // ‚úÖ chat visible
      setTimeout(() => {
        if (!location.href.includes('profile.html')) location.href = 'profile.html';
      }, 1200);
    } else {
      googleBtn.style.display = 'inline-flex';
      statusEl.textContent = 'Signed out';
      attachChat(); // ‚úÖ load chat even when signed out
    }
  });

  function esc(s) {
    return ('' + (s || '')).replace(/[&<>"']/g, m =>
      ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m]));
  }

  function attachChat() {
    msgList.innerHTML = '';
    const ref = db.ref('townhall/messages').limitToLast(100);
    ref.off();
    ref.on('child_added', snap => {
      const d = snap.val() || {};
      const t = new Date(d.ts || Date.now()).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      const div = document.createElement('div');
      div.className = 'msg';
      div.innerHTML = `<strong>${esc(d.name || 'Anon')}</strong> <small>${t}</small><div>${esc(d.text || '')}</div>`;
      msgList.appendChild(div);
      msgList.scrollTop = msgList.scrollHeight;
    });
  }

  function sendMsg() {
    if (!user) { alert('Please sign in first to post.'); return; }
    const text = msgInput.value.trim();
    if (!text) return;
    db.ref('townhall/messages').push({
      uid: user.uid,
      name: user.displayName || user.email,
      text: text,
      ts: firebase.database.ServerValue.TIMESTAMP
    });
    msgInput.value = '';
  }

  sendBtn.onclick = sendMsg;
  msgInput.addEventListener('keypress', e => {
    if (e.key === 'Enter') { e.preventDefault(); sendMsg(); }
  });
});
</script>
</body>
</html>
