<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DealBankers â€” Real Estate Command Hub</title>
  <link rel="icon" href="icon (1).jpg" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #060b11; --accent: #2b74ff; --accent-glow: #4f8cff;
      --text: #eaf2ff; --line: #1e2c3a; --muted: #9db2c7; --chrome: #a8c1ff; --neon: #33aaff;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Orbitron", system-ui, sans-serif;
      background: radial-gradient(circle at 30% 10%, #0b1523 0%, #050910 100%);
      color: var(--text); overflow-x: hidden;
    }
    header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px 20px; border-bottom: 1px solid var(--line);
      background: linear-gradient(90deg, #070d16, #0e1b30 80%, #070d16);
      box-shadow: 0 0 18px rgba(43,116,255,0.25);
    }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: 800; color: var(--chrome); }
    .brand img { width: 42px; height: 42px; border-radius: 10px; box-shadow: 0 0 10px var(--neon); }
    nav { display: flex; gap: 10px; }
    nav a {
      padding: 6px 14px; border-radius: 8px; background: #162238; font-weight: 700;
      color: #bcd1ff; transition: .25s; text-decoration: none;
    }
    nav a:hover { background: var(--accent); color: #fff; box-shadow: 0 0 12px var(--accent-glow); }
    .status { font-size: .8rem; color: var(--muted); }
    main {
      display: grid; grid-template-columns: 1.1fr .9fr; gap: 20px;
      max-width: 1200px; margin: 40px auto; padding: 0 16px;
    }
    .left-col, .right-col {
      background: rgba(15,24,35,.4); border: 1px solid var(--line); border-radius: 14px;
      padding: 24px; box-shadow: inset 0 0 20px rgba(43,116,255,.15);
    }
    .hero { text-align: center; margin-bottom: 24px; }
    .hero h1 { font-size: 2.4rem; margin-bottom: 6px; color: var(--chrome); }
    .hero p { color: #b5cbe0; margin-bottom: 20px; }
    .gbtn {
      display: inline-flex; align-items: center; gap: 10px;
      padding: 12px 20px; border-radius: 12px; border: 1px solid #747775;
      background: #1f1f1f; color: #e8eaed; font-weight: 700; cursor: pointer;
      box-shadow: 0 0 10px rgba(43,116,255,.3);
    }
    .gbtn:hover { background: #2c2c2c; box-shadow: 0 0 14px var(--accent-glow); }
    .gbtn img { width: 20px; height: 20px; }
    .tiles {
      display: grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
      gap: 16px; margin-top: 10px;
    }
    .tile {
      background: linear-gradient(180deg,#111b27,#0c1219);
      border: 1px solid #1d2b3a; border-radius: 16px;
      padding: 20px; text-align: center; cursor: pointer; transition: .3s;
    }
    .tile:hover {
      transform: translateY(-5px); box-shadow: 0 0 20px rgba(43,116,255,.4);
    }
    .tile h3 { margin: 6px 0; color: #fff; font-size: 1.1rem; }
    .tile p { font-size: .9rem; color: #9db2c7; }

    /* Townhall Chat */
    .chat-container {
      border-radius: 14px; background: rgba(15,24,35,.7); border: 1px solid #1e2c3a; padding: 16px;
      display: flex; flex-direction: column; height: 480px;
      box-shadow: inset 0 0 12px rgba(43,116,255,.25);
    }
    .chat-messages { flex: 1; overflow-y: auto; }
    .msg {
      margin-bottom: 10px; padding: 10px;
      border-radius: 10px; background: rgba(255,255,255,.05);
    }
    .msg strong { color: var(--neon); }
    .msg small { color: #9db2c7; font-size: .7rem; margin-left: 4px; }
    .chat-input { display: flex; gap: 10px; margin-top: 10px; }
    .chat-input input {
      flex: 1; padding: 10px; border-radius: 10px; border: 1px solid #294861;
      background: #0e2332; color: #fff;
    }
    .chat-input button {
      padding: 10px 14px; border-radius: 10px; border: 1px solid var(--accent);
      background: #173764; color: #fff; font-weight: 700; cursor: pointer;
    }
    .chat-input button:hover {
      background: var(--accent); box-shadow: 0 0 10px var(--accent-glow);
    }

    footer { text-align: center; margin: 40px auto; color: #88a5bf; font-size: .9rem; }
    footer span { display: block; margin-top: 4px; color: var(--accent); font-weight: 700; }
  </style>
</head>
<body>
<header>
  <div class="brand">
    <img src="icon (1).jpg" /><span>DealBankers</span>
  </div>
  <nav>
    <a href="#">Home</a>
    <a href="profile.html">Tools</a>
    <a href="#townhall">Townhall</a>
    <a href="claims-exchange.html">ClaimChain</a>
  </nav>
  <div class="status" id="authStatus">Signed out</div>
</header>

<main>
  <div class="left-col">
    <div class="hero">
      <h1>DealBankers</h1>
      <p>Your One-Stop Real Estate Portal</p>
      <button id="googleBtn" class="gbtn">
        <img src="https://developers.google.com/identity/images/g-logo.png" /> Sign in with Google
      </button>
    </div>
    <div class="tiles">
      <div class="tile"><h3>Wholesalers</h3><p>Upload leads, view in street view, edit inline, skip trace.</p></div>
      <div class="tile"><h3>Contractors</h3><p>Tools, jobs, micro-loans, and profile filters.</p></div>
      <div class="tile"><h3>Realtors</h3><p>Analyze property data, upload listings, refer deals.</p></div>
      <div class="tile"><h3>Investors</h3><p>Capital, returns, networking, market pulse.</p></div>
    </div>
  </div>

  <div class="right-col" id="townhall">
    <h2 style="text-align:center;color:var(--chrome);text-shadow:0 0 5px var(--accent)">ðŸ”µ Townhall Chat</h2>
    <div class="chat-container">
      <div id="messages" class="chat-messages"></div>
      <div class="chat-input">
        <input id="msgInput" placeholder="Sign in to chat..." disabled />
        <button id="sendBtn" disabled>Send</button>
      </div>
    </div>
  </div>
</main>

<footer>
  Â© <span id="year"></span> DealBankers.com
  <span>Built for Trust. Driven by Data</span>
  <div style="margin-top:10px; font-size: 0.85rem;">
    <a href="https://drive.google.com/drive/u/2/folders/1x4xbW0Vbb5FSP0292WC7qwMIyzsTzgop" 
       target="_blank" 
       style="color: var(--muted); text-decoration: underline;">
      ðŸ“˜ Family Advocacy Docs (Open Source)
    </a>
  </div>
</footer>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
  import { getDatabase, ref, push, onChildAdded, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-database.js";
  import { firebaseConfig } from "./config.js";

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);
  const provider = new GoogleAuthProvider();

  const year = document.getElementById("year");
  year.textContent = new Date().getFullYear();

  const msgList = document.getElementById("messages");
  const msgInput = document.getElementById("msgInput");
  const sendBtn = document.getElementById("sendBtn");
  const authStatus = document.getElementById("authStatus");
  const googleBtn = document.getElementById("googleBtn");

  function esc(s){ return (''+(s||'')).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])) }

  function attachChat(){
    const chatRef = ref(db,"townhall/messages");
    onChildAdded(chatRef, snap=>{
      const d=snap.val()||{};
      const t=new Date(d.ts||Date.now()).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
      const div=document.createElement("div");
      div.className="msg";
      div.innerHTML=`<strong>${esc(d.name||'Anon')}</strong> <small>${t}</small><div>${esc(d.text||'')}</div>`;
      msgList.appendChild(div);
      msgList.scrollTop = msgList.scrollHeight;
    });
  }

  sendBtn.onclick = ()=>{
    if(!auth.currentUser) return alert("Please sign in first.");
    const text = msgInput.value.trim();
    if(!text) return;
    push(ref(db,"townhall/messages"), {
      uid: auth.currentUser.uid,
      name: auth.currentUser.displayName || auth.currentUser.email,
      text,
      ts: serverTimestamp()
    });
    msgInput.value = "";
  };

  msgInput.addEventListener("keypress", e => {
    if(e.key === "Enter"){ e.preventDefault(); sendBtn.click(); }
  });

  googleBtn.onclick = async () => {
    await setPersistence(auth, browserLocalPersistence);
    await signInWithPopup(auth, provider);
    window.location.href = "profile.html";
  };

  onAuthStateChanged(auth, user => {
    if(user){
      authStatus.innerHTML = `Signed in as ${user.displayName||user.email} <a id='logout' style='color:#2b74ff;cursor:pointer;margin-left:6px;'>Sign out</a>`;
      msgInput.disabled = false; sendBtn.disabled = false;
      attachChat();
      document.getElementById("logout").onclick = () => signOut(auth);
    } else {
      authStatus.textContent = "Signed out";
      msgInput.disabled = true; sendBtn.disabled = true;
      attachChat(); // still attach for read-only mode
    }
  });
</script>
</body>
</html>
