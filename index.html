<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>DealBankers ‚Ä¢ Sign in</title>
  <meta name="robots" content="noindex"/>

  <!-- Compat SDKs (pin a single version) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <!-- Your firebaseConfig (must define window.firebaseConfig) -->
  <script src="config.js?v=2025-08-25"></script>

  <style>
    :root{
      --bg1:#0b1118; --bg2:#0e1a24; --bg3:#10283a;
      --panel:#101c27; --line:rgba(255,255,255,.15);
      --text:#eaf1f6; --muted:#9fb3c7; --green:#26cf84; --gold:#ffd36b;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 92% -8%, rgba(93,224,255,.20) 0%, transparent 60%),
        linear-gradient(135deg,var(--bg1),var(--bg2) 55%,var(--bg3));
      color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif;
      min-height:100vh; display:flex; align-items:center; justify-content:center; padding:20px;
    }
    #fbBanner{
      position:fixed; left:0; right:0; top:0;
      background:#7a1020; color:#fff; padding:8px 12px;
      font:13px/1.3 system-ui; z-index:9999; display:none;
    }

    /* Stacked layout */
    .wrap{
      display:flex; flex-direction:column; gap:18px;
      width:100%; max-width:720px; margin:0 auto;
    }
    .card{
      background:linear-gradient(180deg,rgba(255,255,255,.07),rgba(255,255,255,.03));
      border:1px solid var(--line); border-radius:18px; padding:18px;
      box-shadow:0 24px 64px rgba(0,0,0,.5);
      position:relative; overflow:hidden;
    }

    /* Brand card with subtle gold glow */
    .brandCard{
      display:flex; align-items:center; gap:14px;
      padding:18px; border-radius:14px; position:relative;
    }
    .brandCard::before{
      content:""; position:absolute; inset:auto -30% -40% -30%;
      height:260px;
      background:radial-gradient(closest-side, rgba(255,211,107,.26), rgba(255,211,107,0) 70%);
      filter:blur(14px); pointer-events:none;
    }
    .brand{display:flex;gap:12px;align-items:center; position:relative}
    .brand img{width:64px;height:64px;border-radius:12px;object-fit:cover;
      box-shadow:0 16px 40px rgba(255,211,107,.18), 0 6px 20px rgba(0,0,0,.45);}
    .title{font-weight:900;font-size:20px;margin:0}
    .muted{color:var(--muted);font-size:13px}

    .authHead{margin:0 0 10px}
    .status{margin-top:10px;font-size:12px;color:#cfe0f2}

    /* Google button (classic white) */
    .gbtn{
      display:inline-flex; align-items:center; justify-content:center; gap:10px;
      width:100%; padding:12px 14px; border-radius:12px;
      background:#fff; color:#1a1a1a; border:1px solid rgba(0,0,0,.08);
      box-shadow:0 2px 10px rgba(0,0,0,.25);
      cursor:pointer; font-weight:600;
    }
    .gbtn:disabled{opacity:.6; cursor:default}
    .gicon{width:18px;height:18px;display:inline-block}
  </style>
</head>
<body>
  <div id="fbBanner"></div>

  <div class="wrap">
    <!-- Brand / intro -->
    <div class="card">
      <div class="brandCard">
        <div class="brand">
          <img src="icon (1).jpg" alt="DealBankers"/>
          <div>
            <h2 class="title">DealBankers</h2>
            <div class="muted">Secure access to your acquisitions & dispositions portals. Sign in with Google to continue.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Auth -->
    <div class="card" id="authCard">
      <h3 class="authHead">üîê Secure Sign-In</h3>
      <button id="googleBtn" class="gbtn" disabled>
        <svg class="gicon" viewBox="0 0 533.5 544.3" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path fill="#EA4335" d="M533.5 278.4c0-18.6-1.7-36.5-4.9-53.8H272.1v101.8h146.5c-6.3 34.1-25.1 63-53.6 82.3v68h86.7c50.6-46.6 81.8-115.2 81.8-198.3z"/>
          <path fill="#34A853" d="M272.1 544.3c73.9 0 135.9-24.5 181.2-66.6l-86.7-68c-24.1 16.2-55 25.7-94.6 25.7-72.7 0-134.3-49-156.4-114.8H26.7v71.8c45 89.4 137.6 151.9 245.4 151.9z"/>
          <path fill="#4A90E2" d="M115.7 320.6c-10.6-31.8-10.6-66.2 0-98l.1-71.8H26.7c-39.8 79.5-39.8 162.1 0 241.6l89.1-71.8-.1 0z"/>
          <path fill="#FBBC05" d="M272.1 106.2c39.9-.6 78.2 14 107.3 41.4l80.1-80.1C408.3 24.8 346.4.3 272.1 0 164.3 0 71.7 62.5 26.7 151.9l89.1 71.9C137.9 158 199.4 106.2 272.1 106.2z"/>
        </svg>
        Sign in with Google
      </button>
      <div id="authStatus" class="status" aria-live="polite">Auth status: checking‚Ä¶</div>
    </div>
  </div>

  <script>
    // ---------- One-time Firebase init (compat) ----------
    (function initFirebase(){
      const banner = document.getElementById('fbBanner');
      const say = (msg)=>{ banner.textContent = 'Firebase init error: ' + msg; banner.style.display='block'; };
      try{
        if(!window.firebaseConfig){ say('Missing window.firebaseConfig (check config.js).'); return; }
        if(!firebase?.apps?.length) firebase.initializeApp(window.firebaseConfig);
        window.db   = firebase.database();
        window.auth = firebase.auth();
      }catch(e){
        console.error(e);
        say(e.message || String(e));
      }
    })();

    // ---------- Auth wiring ----------
    (function(){
      const statusEl = document.getElementById('authStatus');
      const btn      = document.getElementById('googleBtn');
      let navigated  = false; // prevent double redirects

      function go(path){
        if(navigated) return; navigated = true;
        location.href = path;
      }

      if (!window.auth){
        statusEl.textContent = 'Firebase not ready. Check config.js and API key restrictions.';
        btn.disabled = true;
        return;
      }

      // Ready: enable the button
      btn.disabled = false;

      // If already signed in, jump straight to profile
      auth.onAuthStateChanged(function(user){
        if(user){ statusEl.textContent = 'Signed in. Redirecting‚Ä¶'; go('profile.html'); }
        else { statusEl.textContent = 'Not signed in.'; }
      });

      btn.addEventListener('click', async ()=>{
        if(btn.disabled) return;
        btn.disabled = true; statusEl.textContent = 'Opening Google‚Ä¶';
        try{
          const prov = new firebase.auth.GoogleAuthProvider();
          await auth.signInWithPopup(prov);
          statusEl.textContent = 'Signed in. Redirecting‚Ä¶';
          go('profile.html');
        }catch(e){
          console.error(e);
          statusEl.textContent = 'Sign-in failed: ' + (e.message||e);
          btn.disabled = false;
        }
      });
    })();
  </script>
</body>
</html>
