<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DealBankers • Profile</title>
  <link rel="icon" href="icon (1).jpg">
  <style>
    :root{
      --bg:#0a1218; --card:#0f1c24; --mut:#9fb4c6; --ink:#dff2ff; --edge:#1e3646; --pill:#132937;
      --ok:#21c776;
    }
    html,body{height:100%} body{
      margin:0; background:radial-gradient(1200px 600px at 50% -10%,#0f1b24 0%, #0a1218 45%, #071016 100%);
      color:var(--ink); font:400 16px/1.5 system-ui,Segoe UI,Inter,Roboto,Arial,sans-serif;
    }
    .wrap{max-width:980px;margin:24px auto;padding:0 16px;}
    .tabs{display:flex;gap:.5rem;margin:16px 0 12px}
    .tab{
      padding:.45rem .75rem;border-radius:10px;background:var(--pill);border:1px solid var(--edge);
      color:#cfe8ff;cursor:pointer;font-weight:600
    }
    .tab.active{background:#173345;border-color:#2b5062}
    .card{
      background:var(--card);border:1px solid var(--edge);border-radius:14px;padding:18px;
      box-shadow:0 10px 60px rgba(0,0,0,.28);
    }
    .row{display:flex;gap:10px;align-items:center}
    .row input{flex:1; background:#0c1720;border:1px solid #213a49;border-radius:10px;
      padding:.6rem .75rem;color:#cfe8ff}
    .send{background:var(--ok);border:0;border-radius:10px;padding:.55rem 1.1rem;font-weight:700;color:#04220f;cursor:pointer}
    .dim{color:var(--mut);font-size:.92rem}
  </style>
  <script>
    // simple tab switcher
    function go(tab){
      const url = new URL(location.href);
      url.searchParams.set('tab', tab);
      history.replaceState(null,'',url);
      render(tab);
    }
  </script>
  <script src="config.js"></script>
  <!-- shared auth + header -->
  <script type="module" src="app-auth.js"></script>
</head>
<body>
  <div class="wrap">
    <!-- header injected by DB.renderHeader -->
    <div id="content"></div>
  </div>

  <script type="module">
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    window.DB.renderHeader();

    const content = document.getElementById('content');

    function render(active){
      const t = active || (new URL(location.href).searchParams.get('tab')||'overview');
      const all = ['overview','wholesaler','contractor','realtor','settings'];
      content.innerHTML = `
        <div class="tabs">
          ${all.map(x=>`<button class="tab ${t===x?'active':''}" onclick="go('${x}')">${x[0].toUpperCase()+x.slice(1)}</button>`).join('')}
        </div>
        ${t==='overview'?overview():''}
        ${t==='wholesaler'?jump('Go to <a href="wholesaler.html">Wholesaler portal</a>.'):''}
        ${t==='contractor'?jump('Post jobs and manage crews in the <a href="contractor.html">Contractor portal</a>.'):''}
        ${t==='realtor'?jump('Realtor tools are available here: <a href="realtor.html">Realtor portal</a>.'):''}
        ${t==='settings'?settings():''}
      `;
    }

    const jump = (msg)=>`<div class="card dim">${msg}</div>`;

    const overview = ()=>`
      <div class="card">
        <div class="dim">Capital Open: <b>$300k</b> • Turn: <b>7–10 days</b></div>
        <h3>Townhall (All Users)</h3>
        <div class="row">
          <input id="chatBox" placeholder="Say something to the room… (press Enter to send)" />
          <button class="send" id="sendBtn">Send</button>
        </div>
        <div class="dim" style="margin-top:.6rem" id="chatNote">Connecting…</div>
      </div>
    `;

    const settings = ()=>`
      <div class="card">
        <h3>Settings</h3>
        <div class="dim">User role management & branding here.</div>
      </div>
    `;

    // minimal chat input wiring (placeholder)
    function wireChat(){
      const i = document.getElementById('chatBox');
      const b = document.getElementById('sendBtn');
      if(!i||!b) return;
      const send = ()=>{ if(!i.value.trim()) return; i.value=''; };
      i.addEventListener('keydown', (e)=>{ if(e.key==='Enter') send(); });
      b.onclick = send;
      document.getElementById('chatNote').textContent = 'You are connected.';
    }

    window.DB.requireAuth((user)=>{
      // draw page
      render();
      wireChat();

      // keep header present
      window.DB.renderHeader();
    });

  </script>
</body>
</html>
