<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deal Bankers - User Profile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">

  <!-- Container -->
  <div class="max-w-4xl mx-auto p-6 bg-white shadow-lg mt-8 rounded-lg">
    <h1 class="text-3xl font-bold mb-6 text-center">Your Profile</h1>
    <p class="text-gray-600 mb-4 text-center">Manage your role settings and connect with other Deal Bankers</p>

    <!-- Role Selector -->
    <div class="mb-6">
      <h2 class="text-xl font-semibold mb-2">Select Your Roles</h2>
      <div class="grid grid-cols-2 gap-4">
        <label class="flex items-center space-x-2">
          <input type="checkbox" id="role-contractor" class="form-checkbox h-5 w-5 text-blue-600">
          <span>Contractor</span>
        </label>
        <label class="flex items-center space-x-2">
          <input type="checkbox" id="role-wholesaler" class="form-checkbox h-5 w-5 text-blue-600">
          <span>Wholesaler</span>
        </label>
        <label class="flex items-center space-x-2">
          <input type="checkbox" id="role-realtor" class="form-checkbox h-5 w-5 text-blue-600">
          <span>Realtor</span>
        </label>
        <label class="flex items-center space-x-2">
          <input type="checkbox" id="role-investor" class="form-checkbox h-5 w-5 text-blue-600">
          <span>Investor</span>
        </label>
      </div>
    </div>

    <!-- Contractor Settings -->
    <div id="contractor-settings" class="hidden mb-6 border p-4 rounded-lg bg-gray-50">
      <h3 class="text-lg font-semibold mb-2">Contractor Profile Settings</h3>
      <label class="block mb-2">
        <span>Business Name</span>
        <input type="text" id="contractor-business" class="w-full border rounded px-3 py-2">
      </label>
      <label class="block mb-2">
        <span>License Number</span>
        <input type="text" id="contractor-license" class="w-full border rounded px-3 py-2">
      </label>
      <label class="block mb-2">
        <span>Division (CSI MasterFormat)</span>
        <select id="contractor-division" class="w-full border rounded px-3 py-2">
          <option value="">Select Division</option>
          <option>Division 01 — General Requirements</option>
          <option>Division 02 — Existing Conditions</option>
          <option>Division 03 — Concrete</option>
          <option>Division 04 — Masonry</option>
          <option>Division 05 — Metals</option>
          <option>Division 06 — Wood, Plastics, Composites</option>
          <option>Division 07 — Thermal & Moisture Protection</option>
          <option>Division 08 — Openings</option>
          <option>Division 09 — Finishes</option>
          <option>Division 10 — Specialties</option>
          <option>Division 11 — Equipment</option>
          <option>Division 12 — Furnishings</option>
          <option>Division 13 — Special Construction</option>
          <option>Division 14 — Conveying Equipment</option>
          <option>Division 21 — Fire Suppression</option>
          <option>Division 22 — Plumbing</option>
          <option>Division 23 — HVAC</option>
          <option>Division 25 — Integrated Automation</option>
          <option>Division 26 — Electrical</option>
          <option>Division 27 — Communications</option>
          <option>Division 28 — Electronic Safety & Security</option>
          <option>Division 31 — Earthwork</option>
          <option>Division 32 — Exterior Improvements</option>
          <option>Division 33 — Utilities</option>
        </select>
      </label>
    </div>

    <!-- Wholesaler Settings -->
    <div id="wholesaler-settings" class="hidden mb-6 border p-4 rounded-lg bg-gray-50">
      <h3 class="text-lg font-semibold mb-2">Wholesaler Profile Settings</h3>
      <label class="block mb-2">
        <span>Target Markets</span>
        <input type="text" id="wholesaler-markets" class="w-full border rounded px-3 py-2">
      </label>
      <label class="block mb-2">
        <span>Preferred Deal Types</span>
        <input type="text" id="wholesaler-deals" class="w-full border rounded px-3 py-2">
      </label>
    </div>

    <!-- Realtor Settings -->
    <div id="realtor-settings" class="hidden mb-6 border p-4 rounded-lg bg-gray-50">
      <h3 class="text-lg font-semibold mb-2">Realtor Profile Settings</h3>
      <label class="block mb-2">
        <span>Brokerage Name</span>
        <input type="text" id="realtor-brokerage" class="w-full border rounded px-3 py-2">
      </label>
      <label class="block mb-2">
        <span>License Number</span>
        <input type="text" id="realtor-license" class="w-full border rounded px-3 py-2">
      </label>
    </div>

    <!-- Investor Settings -->
    <div id="investor-settings" class="hidden mb-6 border p-4 rounded-lg bg-gray-50">
      <h3 class="text-lg font-semibold mb-2">Investor Profile Settings</h3>
      <label class="block mb-2">
        <span>Investment Focus</span>
        <input type="text" id="investor-focus" class="w-full border rounded px-3 py-2">
      </label>
      <label class="block mb-2">
        <span>Capital Range</span>
        <input type="text" id="investor-capital" class="w-full border rounded px-3 py-2">
      </label>
    </div>

    <!-- Save Button -->
    <div class="text-center">
      <button id="save-profile" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg">Save Profile</button>
    </div>
  </div>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      databaseURL: "YOUR_DATABASE_URL",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    const roleCheckboxes = {
      contractor: document.getElementById('role-contractor'),
      wholesaler: document.getElementById('role-wholesaler'),
      realtor: document.getElementById('role-realtor'),
      investor: document.getElementById('role-investor')
    };

    const roleSettings = {
      contractor: document.getElementById('contractor-settings'),
      wholesaler: document.getElementById('wholesaler-settings'),
      realtor: document.getElementById('realtor-settings'),
      investor: document.getElementById('investor-settings')
    };

    // Show/Hide settings when role checkbox toggled
    Object.keys(roleCheckboxes).forEach(role => {
      roleCheckboxes[role].addEventListener('change', () => {
        roleSettings[role].classList.toggle('hidden', !roleCheckboxes[role].checked);
      });
    });

    // Load existing user profile
    auth.onAuthStateChanged(user => {
      if (user) {
        const uid = user.uid;
        db.ref('users/' + uid).once('value').then(snapshot => {
          const data = snapshot.val() || {};
          Object.keys(roleCheckboxes).forEach(role => {
            if (data[role]) {
              roleCheckboxes[role].checked = true;
              roleSettings[role].classList.remove('hidden');
              Object.keys(data[role]).forEach(field => {
                const el = document.getElementById(`${role}-${field}`);
                if (el) el.value = data[role][field];
              });
            }
          });
        });
      }
    });

    // Save profile
    document.getElementById('save-profile').addEventListener('click', () => {
      const user = auth.currentUser;
      if (!user) return alert('Not logged in');
      const uid = user.uid;
      const profileData = {};
      Object.keys(roleCheckboxes).forEach(role => {
        if (roleCheckboxes[role].checked) {
          profileData[role] = {};
          const fields = roleSettings[role].querySelectorAll('input, select');
          fields.forEach(f => {
            const id = f.id.replace(`${role}-`, '');
            profileData[role][id] = f.value;
          });
        }
      });
      db.ref('users/' + uid).set(profileData).then(() => {
        alert('Profile saved!');
      });
    });
  </script>

</body>
</html>
