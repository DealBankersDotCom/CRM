<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>DealBankers Dispatch | Mission Control</title>
  <meta name="description" content="On-demand expert dispatch for property managers. Emergency + Make-Ready. Activate response." />
<script src="/config.js"></script>
  <style>
    :root{
      --bg:#070b16;
      --bg2:#0a0f1a;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.04);
      --line:rgba(255,255,255,.10);
      --text:#eaf0ff;
      --muted:rgba(255,255,255,.58);
      --muted2:rgba(255,255,255,.40);
      --radius:22px;

      --blue:#00d4ff;
      --blueDim:rgba(0,212,255,.18);

      --red:#ff3b3b;
      --redDim:rgba(255,59,59,.18);

      --accent: var(--blue);
      --accentDim: var(--blueDim);

      --shadow: 0 18px 55px rgba(0,0,0,.55);
      --shadowSoft: 0 10px 30px rgba(0,0,0,.35);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(circle at 20% 20%, rgba(0,212,255,.12), transparent 55%),
                  radial-gradient(circle at 80% 25%, rgba(255,59,59,.08), transparent 55%),
                  linear-gradient(180deg, var(--bg), var(--bg2));
      color:var(--text);
      overflow-x:hidden;
    }

    /* Subtle grid */
    .grid{
      position:fixed; inset:0;
      opacity:.05;
      background-image:
        linear-gradient(rgba(255,255,255,.10) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,.10) 1px, transparent 1px);
      background-size:52px 52px;
      pointer-events:none;
      z-index:0;
    }

    /* Scan line */
    .scan{
      position:fixed; inset:0;
      pointer-events:none;
      z-index:1;
      background: linear-gradient(180deg,
        transparent 45%,
        var(--accentDim) 50%,
        transparent 55%);
      opacity:.95;
      animation: scan 2.2s linear infinite;
      mix-blend-mode: screen;
    }
    @keyframes scan{
      0%{ transform: translateY(-60%); }
      100%{ transform: translateY(60%); }
    }

    /* Top nav */
    .nav{
      position:fixed; top:0; left:0; right:0;
      z-index:50;
      padding:14px 16px;
      backdrop-filter: blur(14px);
      background: linear-gradient(180deg, rgba(7,11,22,.78), rgba(7,11,22,.18));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .navInner{
      width:min(1180px, 100%);
      margin:0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
      user-select:none;
      min-width: 180px;
    }
    .badgeIcon{
      width:44px; height:44px;
      border-radius:14px;
      border:1px solid color-mix(in srgb, var(--accent) 60%, transparent);
      background: var(--accentDim);
      display:flex; align-items:center; justify-content:center;
      box-shadow: 0 0 30px var(--accentDim);
      position:relative;
      overflow:hidden;
      flex: 0 0 auto;
    }
    .badgeIcon:after{
      content:"";
      position:absolute; inset:-40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 55%);
      transform: rotate(25deg);
      opacity:.15;
    }
    .brandTitle{
      font-weight:800;
      letter-spacing:.14em;
      font-size:14px;
    }
    .brandSub{
      font-size:11px;
      letter-spacing:.34em;
      opacity:.55;
      margin-top:2px;
    }

    .navRight{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    /* Call OPS */
    .callBtn{
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.86);
      font-weight:900;
      letter-spacing:.10em;
      text-transform:uppercase;
      font-size:12px;
      transition: transform .15s ease, filter .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;
      white-space:nowrap;
    }
    .callBtn:hover{
      filter: brightness(1.08);
      border-color: color-mix(in srgb, var(--accent) 35%, rgba(255,255,255,.14));
    }
    .callBtn:active{ transform: scale(.98); }
    .callDot{
      width:10px; height:10px; border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 18px var(--accentDim);
      animation: pulseDot 1.5s ease-in-out infinite;
    }
    @keyframes pulseDot{
      0%,100%{ transform: scale(1); opacity:1;}
      50%{ transform: scale(1.35); opacity:.55;}
    }

    /* Toggle */
    .toggle{
      display:flex;
      gap:6px;
      padding:6px;
      border-radius:999px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
    }
    .tbtn{
      border:0;
      padding:10px 14px;
      border-radius:999px;
      background:transparent;
      color: rgba(255,255,255,.60);
      cursor:pointer;
      font-weight:800;
      letter-spacing:.02em;
      transition: all .18s ease;
      display:flex; align-items:center; gap:10px;
      white-space:nowrap;
    }
    .dot{
      width:9px; height:9px;
      border-radius:999px;
      background: rgba(255,255,255,.22);
      flex: 0 0 auto;
    }
    .tbtn.active{
      background: var(--accentDim);
      color: var(--accent);
    }
    .tbtn.active .dot{
      background: var(--accent);
      box-shadow: 0 0 14px var(--accentDim);
      animation: pulseDot 1.5s ease-in-out infinite;
    }

    /* Layout */
    .wrap{
      width:min(1180px, 100%);
      margin:0 auto;
      padding: 96px 16px 60px;
      position:relative;
      z-index:5;
    }

    /* Hero */
    .hero{
      position:relative;
      border-radius: 28px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
    }
    .heroMedia{
      position:absolute; inset:0;
      z-index:0;
      background:
        radial-gradient(circle at 30% 20%, var(--accentDim), transparent 55%),
        radial-gradient(circle at 75% 35%, rgba(255,255,255,.06), transparent 55%),
        linear-gradient(180deg, rgba(7,11,22,.70), rgba(7,11,22,.85));
    }

    /* ✅ Polished: smaller hero video (keeps your "way smaller" request) */
    .heroVideo{
      position:absolute;
      right: 18px;
      bottom: 18px;
      width: min(320px, 42vw);
      aspect-ratio: 16 / 9;
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.25);
      box-shadow: 0 16px 45px rgba(0,0,0,.55);
      z-index:1;
    }
    .heroVideo video{
      width:100%;
      height:100%;
      object-fit:cover;
      opacity:.65;
      filter: contrast(1.05) saturate(1.05);
      display:block;
    }
    @media (max-width: 980px){
      .heroVideo{
        width: min(300px, 76vw);
        right: 14px;
        bottom: 14px;
      }
    }
    @media (max-width: 560px){
      .heroVideo{
        position:relative;
        right:auto;
        bottom:auto;
        width: 100%;
        margin-top: 14px;
      }
    }

    .heroShade{
      position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(7,11,22,.50), rgba(7,11,22,.92));
      z-index:0;
    }
    .heroInner{
      position:relative;
      z-index:2;
      padding: 26px 20px 20px;
    }
    .kicker{
      font-size:11px;
      letter-spacing:.45em;
      opacity:.70;
      color: var(--accent);
    }
    h1{
      margin: 12px 0 10px;
      font-size: clamp(26px, 4.2vw, 46px);
      font-weight: 300;
      letter-spacing: -.02em;
      line-height:1.05;
    }
    .accentText{ color: var(--accent); font-weight:900; }
    .lead{
      margin: 0;
      max-width: 820px;
      color: rgba(255,255,255,.62);
      font-size: 14.5px;
      line-height:1.45;
    }

    /* Above fold row */
    .ctaRow{
      display:flex;
      gap: 18px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-top: 16px;
    }

    .ctaWrap{
      position:relative;
      width: 210px;
      height: 210px;
      display:flex;
      align-items:center;
      justify-content:center;
      flex: 0 0 auto;
    }
    .ring{
      position:absolute;
      border-radius:999px;
      border:1px solid var(--accent);
      opacity:.12;
      animation: pulse 3.0s ease-in-out infinite;
    }
    .r1{ width:230px; height:230px; animation-delay:0s;}
    .r2{ width:290px; height:290px; animation-delay:.25s; opacity:.10;}
    .r3{ width:350px; height:350px; animation-delay:.5s; opacity:.08;}
    @keyframes pulse{
      0%,100%{ transform:scale(1); opacity:inherit;}
      50%{ transform:scale(1.08); }
    }

    .btnMain{
      width:180px;
      height:180px;
      border-radius:999px;
      border:2px solid var(--accent);
      background: radial-gradient(circle at 30% 30%, var(--accentDim), transparent 70%);
      box-shadow: 0 0 60px var(--accentDim), inset 0 0 60px var(--accentDim);
      cursor:pointer;
      color: var(--text);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap: 10px;
      transition: transform .18s ease, filter .18s ease;
      user-select:none;
    }
    .btnMain:hover{ transform: scale(1.04); filter: brightness(1.05);}
    .btnMain:active{ transform: scale(.98); }
    .btnTop{
      font-size: 12px;
      font-weight: 900;
      letter-spacing: .28em;
      color: var(--accent);
    }
    .btnSub{
      font-size: 11px;
      letter-spacing: .12em;
      opacity:.65;
      text-transform: uppercase;
    }

    .heroStats{
      flex: 1 1 420px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      min-width: 280px;
    }
    .statCard{
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 18px;
      padding: 12px 12px;
      display:flex;
      gap: 12px;
      align-items:flex-start;
      backdrop-filter: blur(10px);
      min-height: 68px;
    }
    .statIcon{
      width:40px; height:40px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: var(--accentDim);
      display:flex; align-items:center; justify-content:center;
      box-shadow: 0 0 26px rgba(0,0,0,.35);
      flex: 0 0 auto;
    }
    .statTitle{ font-weight:900; font-size: 12px; letter-spacing:.06em; }
    .statDesc{ font-size: 12px; color: rgba(255,255,255,.55); margin-top:4px; line-height:1.35; }

    /* Services grid */
    .services{
      margin-top: 12px;
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }
    .svc{
      padding: 12px;
      border-radius: 18px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.08);
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      cursor:pointer;
      min-height: 82px;
    }
    .svc:hover{ transform: translateY(-3px); border-color: color-mix(in srgb, var(--accent) 35%, rgba(255,255,255,.08)); }
    .svc.active{
      border-color: color-mix(in srgb, var(--accent) 55%, transparent);
      background: color-mix(in srgb, var(--accentDim) 50%, rgba(255,255,255,.04));
    }
    .svcTop{
      display:flex; align-items:center; gap:10px;
    }
    .svcIcon{
      width:38px; height:38px;
      border-radius: 14px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; justify-content:center;
      flex: 0 0 auto;
    }
    .svcTitle{ font-weight:900; font-size: 12px; letter-spacing:.05em; }
    .svcDesc{ font-size: 11px; color: rgba(255,255,255,.50); margin-top:6px; line-height:1.25; }

    /* Main two-column */
    .grid2{
      margin-top: 14px;
      display:grid;
      grid-template-columns: 1.35fr .65fr;
      gap: 14px;
    }

    /* Form card */
    .card{
      background: linear-gradient(135deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 22px;
      box-shadow: var(--shadowSoft);
      overflow:hidden;
    }
    .cardHead{
      padding: 16px 16px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .cardHead h2{
      margin:0;
      font-size: 15px;
      letter-spacing:.10em;
      font-weight:900;
      text-transform: uppercase;
    }
    .badgePill{
      border: 1px solid color-mix(in srgb, var(--accent) 50%, transparent);
      color: var(--accent);
      background: var(--accentDim);
      padding: 8px 12px;
      border-radius: 999px;
      font-size: 12px;
      letter-spacing: .12em;
      font-weight: 900;
      white-space:nowrap;
    }
    .cardBody{ padding: 16px; }

    .formGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    label{
      display:block;
      font-size: 11px;
      letter-spacing:.18em;
      text-transform: uppercase;
      opacity:.62;
      margin-bottom:8px;
    }
    input, select, textarea{
      width:100%;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      color: var(--text);
      padding: 12px 12px;
      outline:none;
      transition: border-color .15s ease, box-shadow .15s ease;
      font-size: 14px;
    }
    textarea{ min-height: 120px; resize: vertical; }
    input::placeholder, textarea::placeholder{ color: rgba(255,255,255,.35); }
    input:focus, select:focus, textarea:focus{
      border-color: color-mix(in srgb, var(--accent) 55%, transparent);
      box-shadow: 0 0 0 4px var(--accentDim);
    }
    .full{ grid-column: 1 / -1; }

    .actions{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-top: 14px;
      flex-wrap:wrap;
    }
    .btn{
      border:0;
      cursor:pointer;
      border-radius: 999px;
      padding: 12px 16px;
      font-weight: 900;
      letter-spacing: .12em;
      text-transform: uppercase;
      font-size: 12px;
      transition: transform .15s ease, filter .15s ease, background .15s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn[disabled]{ opacity:.6; cursor:not-allowed; transform:none !important; }
    .btnPrimary{
      background: var(--accent);
      color: #08101a;
      box-shadow: 0 0 24px var(--accentDim);
      padding: 13px 18px;
    }
    .btnPrimary:hover{ transform: scale(1.02); filter: brightness(1.05); }
    .btnPrimary:active{ transform: scale(.98); }

    .btnGhost{
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.80);
      border: 1px solid rgba(255,255,255,.12);
    }
    .btnGhost:hover{ filter: brightness(1.08); }
    .hint{
      font-size: 12px;
      color: rgba(255,255,255,.45);
      line-height:1.35;
      flex: 1 1 220px;
    }

    /* Sidebar */
    .sideItem{
      display:flex;
      gap: 12px;
      align-items:flex-start;
      padding: 14px;
      border-radius: 18px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.08);
      margin-bottom: 12px;
    }
    .sideIcon{
      width:44px; height:44px;
      border-radius: 16px;
      background: var(--accentDim);
      border: 1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; justify-content:center;
      flex: 0 0 auto;
      box-shadow: 0 0 22px rgba(0,0,0,.35);
    }
    .sideTitle{ font-weight:900; letter-spacing:.06em; font-size: 12px; }
    .sideDesc{ font-size: 12px; color: rgba(255,255,255,.52); margin-top:4px; line-height:1.35; }

    /* Footer */
    .footer{
      margin-top: 18px;
      padding: 18px 6px 0;
      opacity:.65;
      display:flex;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:10px;
      font-size: 12px;
      border-top: 1px solid rgba(255,255,255,.06);
    }

    /* Toast */
    .toast{
      position: fixed;
      right: 16px;
      bottom: 16px;
      z-index: 9999;
      width: min(420px, calc(100% - 32px));
      padding: 14px 14px;
      border-radius: 18px;
      background: rgba(10,15,26,.92);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      transform: translateY(20px);
      opacity: 0;
      pointer-events:none;
      transition: opacity .2s ease, transform .2s ease;
    }
    .toast.show{
      opacity:1;
      transform: translateY(0);
      pointer-events:auto;
    }
    .toastRow{
      display:flex;
      gap: 12px;
      align-items:flex-start;
    }
    .toastIcon{
      width:40px; height:40px;
      border-radius: 14px;
      background: var(--accentDim);
      border: 1px solid color-mix(in srgb, var(--accent) 50%, transparent);
      display:flex; align-items:center; justify-content:center;
      flex: 0 0 auto;
    }
    .toastTitle{
      font-weight: 900;
      letter-spacing:.06em;
      font-size: 13px;
      margin:0;
    }
    .toastDesc{
      margin: 6px 0 0;
      font-size: 12px;
      color: rgba(255,255,255,.55);
      line-height:1.35;
    }
    .toastClose{
      margin-left:auto;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.80);
      border-radius: 999px;
      padding: 6px 10px;
      cursor:pointer;
      font-weight:800;
      letter-spacing:.08em;
      font-size: 11px;
      white-space:nowrap;
    }
    .toastClose:hover{ filter: brightness(1.08); }

    /* Tiny SVG icons */
    .ico{ width:20px; height:20px; display:block; }
    .icoSmall{ width:18px; height:18px; display:block; }

    /* Responsive */
    @media (max-width: 980px){
      .grid2{ grid-template-columns: 1fr; }
      .heroStats{ grid-template-columns: 1fr; }
      .ctaRow{ justify-content:center; }
      .services{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }

    /* Mobile nav fix: toggle always visible */
    @media (max-width: 560px){
      .nav{ padding:12px 12px; }
      .navInner{ flex-wrap:wrap; align-items:center; gap:10px; }
      .brand{ min-width: unset; }
      .navRight{
        width:100%;
        justify-content:space-between;
        gap:10px;
      }
      .toggle{
        flex: 1 1 auto;
        justify-content:space-between;
        min-width: 0;
      }
      .tbtn{
        padding:9px 10px;
        font-size:12px;
        flex: 1 1 0;
        justify-content:center;
      }
      .dot{ width:8px; height:8px; }
      .callBtn{
        padding:9px 10px;
        font-size:11px;
      }
      .wrap{ padding-top: 120px; } /* account for wrapped nav */
    }

    /* Really small phones: stack call + toggle */
    @media (max-width: 390px){
      .navRight{ flex-direction:column; align-items:stretch; }
      .callBtn{ justify-content:center; }
      .toggle{ width:100%; }
      .wrap{ padding-top: 152px; }
    }

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce){
      .scan, .ring, .callDot{ animation:none !important; }
      *{ scroll-behavior:auto !important; }
    }
  </style>
</head>

<body>
  <div class="grid"></div>
  <div class="scan"></div>

  <!-- NAV -->
  <div class="nav">
    <div class="navInner">
      <div class="brand">
        <div class="badgeIcon" aria-hidden="true">
          <!-- Radio icon -->
          <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
            <path d="M4.9 19.1a10 10 0 0 1 0-14.2" />
            <path d="M7.8 16.2a6 6 0 0 1 0-8.4" />
            <path d="M16.2 7.8a6 6 0 0 1 0 8.4" />
            <path d="M19.1 4.9a10 10 0 0 1 0 14.2" />
            <circle cx="12" cy="12" r="1" />
          </svg>
        </div>
        <div>
          <div class="brandTitle">DEALBANKERS</div>
          <div class="brandSub">DISPATCH</div>
        </div>
      </div>

      <div class="navRight">
        <!-- CALL OPS -->
        <a class="callBtn" id="callOpsBtn" href="tel:+15128435181" aria-label="Call DealBankers Ops">
          <span class="callDot" aria-hidden="true"></span>
          CALL OPS
        </a>

        <!-- Toggle -->
        <div class="toggle" role="tablist" aria-label="Dispatch mode">
          <button class="tbtn active" id="standardBtn" type="button" role="tab" aria-selected="true">
            <span class="dot"></span> Standard
          </button>
          <button class="tbtn" id="emergencyBtn" type="button" role="tab" aria-selected="false">
            <span class="dot"></span> Emergency
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="wrap">

    <!-- HERO -->
    <div class="hero">
      <div class="heroMedia"></div>

      <!-- ✅ Smaller video window -->
      <div class="heroVideo" aria-label="Dispatch preview video">
        <video autoplay muted loop playsinline>
          <source src="/images/dispatch.mp4" type="video/mp4">
        </video>
      </div>

      <div class="heroShade"></div>

      <div class="heroInner">
        <div class="kicker">PROPERTY OPERATIONS COMMAND</div>
        <h1>
          When things go wrong,<br>
          <span class="accentText" id="accentPhrase">you activate.</span>
        </h1>
        <p class="lead">
          On-demand expert dispatch for property managers. Emergency, make-ready, rapid cleanup — one command.
        </p>

        <div class="ctaRow">
          <!-- Big round button -->
          <div class="ctaWrap" aria-label="Primary dispatch action">
            <div class="ring r1"></div>
            <div class="ring r2"></div>
            <div class="ring r3"></div>

            <button class="btnMain" id="primaryBtn" type="button">
              <!-- Target icon -->
              <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                <circle cx="12" cy="12" r="10"></circle>
                <circle cx="12" cy="12" r="6"></circle>
                <circle cx="12" cy="12" r="2"></circle>
              </svg>
              <div class="btnTop" id="btnTop">DISPATCH</div>
              <div class="btnSub" id="btnSub">TECHNICIAN</div>
            </button>
          </div>

          <!-- Stats -->
          <div class="heroStats">
            <div class="statCard">
              <div class="statIcon">
                <!-- Clock -->
                <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M12 6v6l4 2"></path>
                </svg>
              </div>
              <div>
                <div class="statTitle" id="etaTitle">RESPONSE WINDOW</div>
                <div class="statDesc" id="etaDesc">Target response: &lt; 2 hours</div>
              </div>
            </div>

            <div class="statCard">
              <div class="statIcon">
                <!-- Shield -->
                <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                  <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
              </div>
              <div>
                <div class="statTitle">VETTED OPERATORS</div>
                <div class="statDesc">Trusted techs + quality control</div>
              </div>
            </div>

            <div class="statCard">
              <div class="statIcon">
                <!-- MapPin -->
                <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                  <path d="M12 21s-6-5-6-10a6 6 0 0 1 12 0c0 5-6 10-6 10z"></path>
                  <circle cx="12" cy="11" r="2"></circle>
                </svg>
              </div>
              <div>
                <div class="statTitle">REAL-TIME UPDATES</div>
                <div class="statDesc">Status + ETA you can rely on</div>
              </div>
            </div>

            <div class="statCard">
              <div class="statIcon">
                <!-- FileText -->
                <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <path d="M14 2v6h6"></path>
                  <path d="M16 13H8"></path>
                  <path d="M16 17H8"></path>
                  <path d="M10 9H8"></path>
                </svg>
              </div>
              <div>
                <div class="statTitle">ONE THREAD</div>
                <div class="statDesc">Notes, photos, invoice in one place</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Services selector -->
        <div class="services" id="servicesGrid" aria-label="Services"></div>
      </div>
    </div>

    <!-- MAIN: Form + Sidebar -->
    <div class="grid2">
      <!-- FORM -->
      <div class="card">
        <div class="cardHead">
          <div>
            <h2>Dispatch Portal</h2>
            <div class="hint">Create a mission request. Required: name, phone, address.</div>
          </div>
          <div class="badgePill" id="modePill">BLUE CHANNEL</div>
        </div>

        <div class="cardBody">
          <form id="dispatchForm" autocomplete="on">
            <div class="formGrid">
              <div>
                <label for="company">Company / Portfolio (optional)</label>
                <input id="company" name="company" placeholder="ABC Property Management" />
              </div>

              <div>
                <label for="service">Service Type</label>
                <select id="service" name="service"></select>
              </div>

              <div>
                <label for="name">Requester Name *</label>
                <input id="name" name="name" placeholder="Your name" required />
              </div>

              <div>
                <label for="phone">Phone *</label>
                <input id="phone" name="phone" placeholder="(512) 843-5181" required />
              </div>

              <div class="full">
                <label for="address">Property Address *</label>
                <input id="address" name="address" placeholder="123 Main St, San Antonio, TX" required />
              </div>

              <div>
                <label for="unit">Unit / Suite (optional)</label>
                <input id="unit" name="unit" placeholder="Unit 204 / Suite B" />
              </div>

              <div class="full">
                <label for="notes">Problem Notes</label>
                <textarea id="notes" name="notes" placeholder="What happened? Access instructions? Water shutoff? Gate code?"></textarea>
              </div>
            </div>

            <div class="actions">
              <button class="btn btnPrimary" type="submit" id="submitBtn">
                ACTIVATE MISSION
              </button>

              <button class="btn btnGhost" type="button" id="viewMissionsBtn">
                VIEW LOG
              </button>

              <div class="hint" id="formHint">
                Tip: include shutoff location / lockbox / gate code for faster response.
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- SIDEBAR -->
      <div class="card">
        <div class="cardHead">
          <div>
            <h2>Command Guarantees</h2>
            <div class="hint">What PMs feel when they use this portal.</div>
          </div>
          <div class="badgePill" style="opacity:.9;">MISSION READY</div>
        </div>

        <div class="cardBody">
          <div class="sideItem">
            <div class="sideIcon">
              <!-- Navigation icon -->
              <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                <path d="M3 11l19-9-9 19-2-8-8-2z"></path>
              </svg>
            </div>
            <div>
              <div class="sideTitle">SELECT → PIN → DEPLOY</div>
              <div class="sideDesc">Choose service, add notes, and dispatch an operator with one command.</div>
            </div>
          </div>

          <div class="sideItem">
            <div class="sideIcon">
              <!-- Radio icon -->
              <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                <path d="M4.9 19.1a10 10 0 0 1 0-14.2" />
                <path d="M7.8 16.2a6 6 0 0 1 0-8.4" />
                <path d="M16.2 7.8a6 6 0 0 1 0 8.4" />
                <path d="M19.1 4.9a10 10 0 0 1 0 14.2" />
                <circle cx="12" cy="12" r="1" />
              </svg>
            </div>
            <div>
              <div class="sideTitle">SINGLE CHANNEL</div>
              <div class="sideDesc">One thread for status, photos, notes, and invoice.</div>
            </div>
          </div>

          <div class="sideItem">
            <div class="sideIcon">
              <!-- Clock icon -->
              <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M12 6v6l4 2"></path>
              </svg>
            </div>
            <div>
              <div class="sideTitle" id="sideEtaTitle">RESPONSE WINDOW</div>
              <div class="sideDesc" id="sideEtaDesc">Target response: &lt; 2 hours (standard)</div>
            </div>
          </div>

          <div class="sideItem" style="margin-bottom:0;">
            <div class="sideIcon">
              <!-- Shield icon -->
              <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
              </svg>
            </div>
            <div>
              <div class="sideTitle">VETTED OPERATORS</div>
              <div class="sideDesc">Trusted technicians. Quality control. No chasing vendors.</div>
            </div>
          </div>

          <div class="footer">
            <div>Rapid Response for Real Assets</div>
            <div>© <span id="year"></span> DealBankers</div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- TOAST -->
  <div class="toast" id="toast" role="status" aria-live="polite">
    <div class="toastRow">
      <div class="toastIcon" aria-hidden="true">
        <!-- Target -->
        <svg class="icoSmall" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent)">
          <circle cx="12" cy="12" r="10"></circle>
          <circle cx="12" cy="12" r="6"></circle>
          <circle cx="12" cy="12" r="2"></circle>
        </svg>
      </div>
      <div>
        <p class="toastTitle" id="toastTitle">Mission Activated</p>
        <p class="toastDesc" id="toastDesc">Request logged.</p>
      </div>
      <button class="toastClose" id="toastClose" type="button">CLOSE</button>
    </div>
  </div>

  <!-- =========================
       FIREBASE + APP LOGIC
       ========================= -->
  <script type="module">
    // =========================
    // FIREBASE CONFIG (PASTE YOURS)
    // =========================
    const firebaseConfig = {
      apiKey: "PASTE_API_KEY",
      authDomain: "deal-bankers.firebaseapp.com",
      projectId: "deal-bankers",
      storageBucket: "deal-bankers.appspot.com",
      messagingSenderId: "PASTE_SENDER_ID",
      appId: "PASTE_APP_ID"
      // measurementId optional
    };

    // =========================
    // OPTIONAL: EMAIL / FUNCTION CONFIG
    // =========================
    const OPS_PHONE_E164 = "+15128435181"; // (512) 843-5181

    // Option A: raw HTTPS function endpoint
    const EMAIL_ENDPOINT = ""; // optional

    // Option B: callable function name (recommended once you deploy callable)
    const FUNCTIONS_CALLABLE_NAME = ""; // optional

    // Mailto fallback
    const MAILTO_TO = "aptbidsonline@gmail.com";

    // =========================
    // FIREBASE IMPORTS
    // =========================
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
    import {
      getFirestore, collection, doc, setDoc, getDocs,
      query, orderBy, limit, serverTimestamp, onSnapshot
    } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";
    import { getFunctions, httpsCallable } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-functions.js";

    // =========================
    // INIT FIREBASE
    // =========================
    let app = null;
    let db = null;
    let functions = null;
    let firebaseReady = false;

    try{
      app = initializeApp(firebaseConfig);
      db = getFirestore(app);
      functions = getFunctions(app);
      firebaseReady = true;
    }catch(err){
      console.warn("Firebase init failed (running in fallback mode):", err);
      firebaseReady = false;
    }

    // =========================
    // SERVICES
    // =========================
    const SERVICES = [
      { value: "emergency-plumbing", label: "Emergency Plumbing", desc: "Burst pipes, leaks, flooding", icon: "droplets" },
      { value: "water-extraction", label: "Water Extraction", desc: "Rapid flood response", icon: "zap" },
      { value: "make-ready", label: "Make-Ready", desc: "Unit turnovers, prep work", icon: "home" },
      { value: "porter-cleanup", label: "Porter / Cleanup", desc: "Deep clean, debris removal", icon: "brush" },
      { value: "commercial-repairs", label: "Commercial Repairs", desc: "HVAC, electrical, structural", icon: "wrench" },
      { value: "hydro-jet", label: "Hydro-Jet Service", desc: "Drain clearing, sewer lines", icon: "building" }
    ];

    // =========================
    // ELEMENTS
    // =========================
    const standardBtn = document.getElementById("standardBtn");
    const emergencyBtn = document.getElementById("emergencyBtn");
    const btnTop = document.getElementById("btnTop");
    const btnSub = document.getElementById("btnSub");
    const etaDesc = document.getElementById("etaDesc");
    const modePill = document.getElementById("modePill");
    const sideEtaDesc = document.getElementById("sideEtaDesc");
    const primaryBtn = document.getElementById("primaryBtn");
    const callOpsBtn = document.getElementById("callOpsBtn");

    const form = document.getElementById("dispatchForm");
    const submitBtn = document.getElementById("submitBtn");
    const companyEl = document.getElementById("company");
    const serviceEl = document.getElementById("service");
    const nameEl = document.getElementById("name");
    const phoneEl = document.getElementById("phone");
    const addressEl = document.getElementById("address");
    const unitEl = document.getElementById("unit");
    const notesEl = document.getElementById("notes");
    const viewMissionsBtn = document.getElementById("viewMissionsBtn");

    const servicesGrid = document.getElementById("servicesGrid");

    const toast = document.getElementById("toast");
    const toastTitle = document.getElementById("toastTitle");
    const toastDesc = document.getElementById("toastDesc");
    const toastClose = document.getElementById("toastClose");

    document.getElementById("year").textContent = new Date().getFullYear();
    callOpsBtn.href = "tel:" + OPS_PHONE_E164;

    // =========================
    // STATE
    // =========================
    let mode = "standard"; // standard | emergency
    let selectedService = "make-ready";
    let activeMissionUnsub = null;

    // =========================
    // HELPERS
    // =========================
    function showToast(title, desc){
      toastTitle.textContent = title;
      toastDesc.textContent = desc;
      toast.classList.add("show");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()=> toast.classList.remove("show"), 5200);
    }
    toastClose.addEventListener("click", () => toast.classList.remove("show"));

    function setAccent(nextMode){
      mode = nextMode;
      const root = document.documentElement;

      if(mode === "emergency"){
        root.style.setProperty("--accent", "var(--red)");
        root.style.setProperty("--accentDim", "var(--redDim)");

        emergencyBtn.classList.add("active");
        standardBtn.classList.remove("active");
        emergencyBtn.setAttribute("aria-selected", "true");
        standardBtn.setAttribute("aria-selected", "false");

        btnTop.textContent = "CALL";
        btnSub.textContent = "NOW";
        etaDesc.textContent = "Target response: < 30 minutes";
        sideEtaDesc.textContent = "Target response: < 30 minutes (emergency)";
        modePill.textContent = "RED CHANNEL";
        selectedService = "emergency-plumbing";

      } else {
        root.style.setProperty("--accent", "var(--blue)");
        root.style.setProperty("--accentDim", "var(--blueDim)");

        standardBtn.classList.add("active");
        emergencyBtn.classList.remove("active");
        standardBtn.setAttribute("aria-selected", "true");
        emergencyBtn.setAttribute("aria-selected", "false");

        btnTop.textContent = "DISPATCH";
        btnSub.textContent = "TECHNICIAN";
        etaDesc.textContent = "Target response: < 2 hours";
        sideEtaDesc.textContent = "Target response: < 2 hours (standard)";
        modePill.textContent = "BLUE CHANNEL";
        selectedService = "make-ready";
      }

      serviceEl.value = selectedService;
      updateServiceGridActive();
    }

    function renderServiceOptions(){
      serviceEl.innerHTML = "";
      for(const s of SERVICES){
        const opt = document.createElement("option");
        opt.value = s.value;
        opt.textContent = s.label;
        serviceEl.appendChild(opt);
      }
      serviceEl.value = selectedService;
    }

    function iconSvg(name){
      const stroke = 'stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"';
      const color = 'style="color:rgba(255,255,255,.55)"';
      if(name === "droplets") return `<svg class="icoSmall" viewBox="0 0 24 24" ${color} ${stroke}><path d="M12 2s6 7 6 12a6 6 0 0 1-12 0c0-5 6-12 6-12z"/></svg>`;
      if(name === "zap") return `<svg class="icoSmall" viewBox="0 0 24 24" ${color} ${stroke}><path d="M13 2L3 14h7l-1 8 10-12h-7l1-8z"/></svg>`;
      if(name === "home") return `<svg class="icoSmall" viewBox="0 0 24 24" ${color} ${stroke}><path d="M3 10l9-7 9 7v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><path d="M9 22V12h6v10"/></svg>`;
      if(name === "brush") return `<svg class="icoSmall" viewBox="0 0 24 24" ${color} ${stroke}><path d="M9 11l8-8 4 4-8 8"/><path d="M7 13c-2 0-4 2-4 4 0 1 1 2 2 2 2 0 4-2 4-4 0-1-1-2-2-2z"/><path d="M14 6l4 4"/></svg>`;
      if(name === "wrench") return `<svg class="icoSmall" viewBox="0 0 24 24" ${color} ${stroke}><path d="M14.7 6.3a4 4 0 0 0-5.7 5.6l-6.3 6.3a2 2 0 0 0 2.8 2.8l6.3-6.3a4 4 0 0 0 5.6-5.7l-2.2 2.2-3-3 2.5-2.4z"/></svg>`;
      if(name === "building") return `<svg class="icoSmall" viewBox="0 0 24 24" ${color} ${stroke}><path d="M3 22V2h14v20"/><path d="M7 6h6"/><path d="M7 10h6"/><path d="M7 14h6"/><path d="M19 22V8h2v14"/></svg>`;
      return "";
    }

    function renderServiceGrid(){
      servicesGrid.innerHTML = "";
      SERVICES.forEach(s => {
        const div = document.createElement("div");
        div.className = "svc";
        div.dataset.value = s.value;
        div.innerHTML = `
          <div class="svcTop">
            <div class="svcIcon">${iconSvg(s.icon)}</div>
            <div class="svcTitle">${s.label}</div>
          </div>
          <div class="svcDesc">${s.desc}</div>
        `;
        div.addEventListener("click", () => {
          selectedService = s.value;
          serviceEl.value = s.value;
          updateServiceGridActive();
        });
        servicesGrid.appendChild(div);
      });
      updateServiceGridActive();
    }

    function updateServiceGridActive(){
      [...servicesGrid.querySelectorAll(".svc")].forEach(el => {
        el.classList.toggle("active", el.dataset.value === selectedService);
      });
    }

    function getServiceLabel(value){
      const s = SERVICES.find(x => x.value === value);
      return s ? s.label : value;
    }

    function missionId(){
      return "M-" + Date.now().toString().slice(-9);
    }

    // Local fallback log
    function saveMissionLocal(payload){
      const key = "db_dispatch_missions";
      const existing = JSON.parse(localStorage.getItem(key) || "[]");
      existing.unshift(payload);
      localStorage.setItem(key, JSON.stringify(existing));
    }

    // Firestore write
    async function saveMissionFirestore(payload){
      if(!firebaseReady) return { ok:false, reason:"firebase-not-ready" };
      const ref = doc(collection(db, "dispatchMissions"), payload.id);
      await setDoc(ref, {
        ...payload,
        createdAtServer: serverTimestamp(),
        status: "new",
        statusMessage: "Received. Awaiting confirmation.",
        etaMinutes: payload.mode === "emergency" ? 30 : 120
      }, { merge: true });
      return { ok:true, ref };
    }

    // Real-time listener for "actual responses"
    function listenForMissionUpdates(missionDocRef){
      if(activeMissionUnsub){
        try{ activeMissionUnsub(); }catch(_){}
        activeMissionUnsub = null;
      }
      activeMissionUnsub = onSnapshot(missionDocRef, (snap) => {
        if(!snap.exists()) return;
        const d = snap.data();
        if(!d) return;

        const status = (d.status || "").toUpperCase();
        const msg = d.statusMessage || "";
        const eta = (typeof d.etaMinutes === "number") ? ` • ETA ~${d.etaMinutes}m` : "";

        if(status && status !== "NEW"){
          showToast(`UPDATE: ${status}`, `${msg}${eta}`);
        }
      });
    }

    function buildMailto(payload){
      const subject = encodeURIComponent(`DISPATCH REQUEST ${payload.mode.toUpperCase()} • ${payload.serviceLabel} • ${payload.id}`);
      const body = encodeURIComponent(
        `MISSION ID: ${payload.id}\n` +
        `MODE: ${payload.mode}\n` +
        `SERVICE: ${payload.serviceLabel}\n` +
        `COMPANY: ${payload.company || "(n/a)"}\n` +
        `REQUESTER: ${payload.name}\n` +
        `PHONE: ${payload.phone}\n` +
        `ADDRESS: ${payload.address}\n` +
        `UNIT/SUITE: ${payload.unit || "(n/a)"}\n\n` +
        `NOTES:\n${payload.notes || "(none)"}\n\n` +
        `— DealBankers Dispatch Portal`
      );
      return `mailto:${MAILTO_TO}?subject=${subject}&body=${body}`;
    }

    async function sendToEndpoint(payload){
      // Callable function
      if(firebaseReady && FUNCTIONS_CALLABLE_NAME){
        try{
          const fn = httpsCallable(functions, FUNCTIONS_CALLABLE_NAME);
          const res = await fn(payload);
          return { ok:true, result: res?.data };
        }catch(err){
          return { ok:false, reason:"callable-failed", err: String(err) };
        }
      }

      // Raw URL
      if(!EMAIL_ENDPOINT) return { ok:false, reason:"no-endpoint" };
      try{
        const res = await fetch(EMAIL_ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
        if(!res.ok){
          const txt = await res.text().catch(()=> "");
          return { ok:false, reason:"bad-status", status:res.status, txt };
        }
        return { ok:true };
      }catch(err){
        return { ok:false, reason:"network", err: String(err) };
      }
    }

    async function openMissionLog(){
      if(firebaseReady){
        try{
          // ✅ FIX: you were ordering by createdAt but writing createdAtServer.
          // Use createdAtServer for ordering.
          const qy = query(collection(db, "dispatchMissions"), orderBy("createdAtServer", "desc"), limit(20));
          const snap = await getDocs(qy);
          if(snap.empty){
            showToast("No missions yet", "Submit a dispatch request to start the mission log.");
            return;
          }
          const lines = [];
          snap.forEach(docSnap => {
            const m = docSnap.data();
            const status = (m.status || "new").toUpperCase();
            lines.push(`${m.id} | ${status} | ${m.mode?.toUpperCase()} | ${m.serviceLabel} | ${m.address} | ${m.name} | ${m.phone}`);
          });
          alert("Recent Missions (Firestore log):\n\n" + lines.join("\n"));
          return;
        }catch(err){
          console.warn("Firestore log read failed, using local fallback:", err);
        }
      }

      const key = "db_dispatch_missions";
      const existing = JSON.parse(localStorage.getItem(key) || "[]");
      if(!existing.length){
        showToast("No missions yet", "Submit a dispatch request to start the mission log.");
        return;
      }
      const lines = existing.slice(0, 14).map(m =>
        `${m.id} | ${(m.status || m.mode || "").toUpperCase()} | ${m.serviceLabel} | ${m.address} | ${m.name} | ${m.phone}`
      );
      alert("Recent Missions (local log):\n\n" + lines.join("\n"));
    }

    // =========================
    // EVENTS
    // =========================
    standardBtn.addEventListener("click", () => setAccent("standard"));
    emergencyBtn.addEventListener("click", () => setAccent("emergency"));

    serviceEl.addEventListener("change", (e) => {
      selectedService = e.target.value;
      updateServiceGridActive();
    });

    primaryBtn.addEventListener("click", () => {
      if(mode === "emergency"){
        window.location.href = "tel:" + OPS_PHONE_E164;
        return;
      }
      nameEl.scrollIntoView({ behavior: "smooth", block: "center" });
      nameEl.focus();
    });

    viewMissionsBtn.addEventListener("click", openMissionLog);

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const name = nameEl.value.trim();
      const phone = phoneEl.value.trim();
      const address = addressEl.value.trim();

      if(!name || !phone || !address){
        showToast("Missing required fields", "Name, phone, and property address are required.");
        return;
      }

      const payload = {
        id: missionId(),
        createdAt: new Date().toISOString(),
        mode,
        service: selectedService,
        serviceLabel: getServiceLabel(selectedService),
        company: companyEl.value.trim(),
        name,
        phone,
        address,
        unit: unitEl.value.trim(),
        notes: notesEl.value.trim(),
        opsPhone: OPS_PHONE_E164
      };

      const oldBtnText = submitBtn.textContent;
      submitBtn.disabled = true;
      submitBtn.textContent = "SENDING…";

      saveMissionLocal(payload);

      let firestoreRef = null;
      if(firebaseReady){
        try{
          showToast("Logging…", "Saving mission to DealBankers HQ.");
          const saved = await saveMissionFirestore(payload);
          if(saved.ok) firestoreRef = saved.ref;
          if(firestoreRef) listenForMissionUpdates(firestoreRef);
        }catch(err){
          console.warn("Firestore save failed:", err);
          showToast("Offline Mode", "Could not reach database. Saved locally for now.");
        }
      } else {
        showToast("Offline Mode", "Firebase not configured yet. Saved locally for now.");
      }

      showToast("Transmitting…", "Sending mission to Ops.");
      const sent = await sendToEndpoint(payload);

      if(sent.ok){
        showToast("Mission Activated", `${payload.id} sent • ${payload.serviceLabel} • ${mode === "emergency" ? "RED" : "BLUE"} channel`);
        if(firebaseReady && firestoreRef){
          try{
            await setDoc(firestoreRef, {
              status: "received",
              statusMessage: "Ops notified. Awaiting technician confirmation."
            }, { merge: true });
          }catch(_){}
        }
      } else {
        showToast("Fallback Mode", "Opening email draft to send mission to Ops.");
        window.location.href = buildMailto(payload);
      }

      unitEl.value = "";
      notesEl.value = "";

      submitBtn.disabled = false;
      submitBtn.textContent = oldBtnText;
    });

    // =========================
    // INIT
    // =========================
    renderServiceOptions();
    renderServiceGrid();
    setAccent("standard");

    if(firebaseReady === false){
      console.warn("Firebase is not ready. Paste firebaseConfig values in this file to enable real missions + realtime updates.");
    }
  </script>
</body>
</html>
