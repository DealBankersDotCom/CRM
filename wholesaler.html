<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Acquisition ‚Ä¢ DealBankers</title>
<link rel="icon" type="image/jpeg" href="icon (1).jpg"/>
<style>
  :root{
    --bg:#0e1721; --panel:#0f1c28; --line:#1e3343;
    --text:#edf5fb; --muted:#9fb4c6; --cta:#1ecf7a; --cta2:#ffd36b;
  }
  *{box-sizing:border-box} body{margin:0;background:linear-gradient(135deg,#0b1218,#0e1a24 50%,#102534);color:var(--text);font-family:system-ui,Segoe UI,Arial,sans-serif;padding:8px}
  .wrap{max-width:1100px;margin:0 auto}
  .card{border:1px solid var(--line);border-radius:16px;background:var(--panel);overflow:hidden}
  .top{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--line)}
  .crumbs{font-size:12px;color:var(--muted)} .dot{display:inline-block;width:6px;height:6px;border-radius:99px;background:#5de0ff;margin:0 6px}
  .status{font-size:12px;color:#dff1ff}

  /* Minimal sticky toolbar */
  .bar{position:sticky;top:0;z-index:5;background:linear-gradient(180deg,rgba(255,255,255,.06),transparent);border-bottom:1px solid var(--line)}
  .bar-inner{display:flex;align-items:center;gap:10px;padding:10px}
  .cta{
    flex:1 1 auto; text-align:center; padding:12px 14px; border-radius:12px;
    background:linear-gradient(180deg,var(--cta),#1aa663); color:#08140d;
    font-weight:900; letter-spacing:.02em; border:0; cursor:pointer;
  }
  .icons{display:flex;gap:8px;flex-wrap:wrap}
  .ico{
    width:40px;height:40px;border-radius:10px;border:1px solid var(--line);
    background:#0e2332; display:grid; place-items:center; cursor:pointer; text-decoration:none; color:#e9f4ff;
  }
  .ico:hover{background:#143142}
  .ico[disabled]{opacity:.4;pointer-events:none}
  .ico span{font-size:18px;line-height:1}

  /* Lead body */
  .pad{padding:12px}
  .lead{border:1px solid var(--line);border-radius:12px;background:#0d1f2c}
  .ttl{padding:12px 14px;border-bottom:1px solid var(--line);font-weight:900}
  .body{padding:10px 12px}
  .name{font-weight:900;font-size:18px;margin:2px 0 10px}
  details{background:#0c1b27;border:1px solid var(--line);border-radius:10px;margin:8px 0;overflow:hidden}
  summary{padding:10px 12px;cursor:pointer;font-weight:800}
  .map{width:100%;height:210px;border:0;border-radius:10px;background:#fff;margin-top:8px}
  .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .chip{font-size:12px;font-weight:700;padding:6px 10px;border-radius:999px;background:#0e2332;border:1px solid var(--line);color:#cfe1f1}

  /* Mobile tweaks */
  @media (max-width:480px){
    .bar-inner{gap:8px;padding:8px}
    .cta{padding:10px}
    .ico{width:36px;height:36px;border-radius:9px}
    .map{height:190px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <section class="card">
      <div class="top">
        <div class="crumbs">Wholesaler <span class="dot"></span> Acquisition</div>
        <div class="status" id="status">Loading‚Ä¶</div>
      </div>

      <!-- Minimal toolbar -->
      <div class="bar">
        <div class="bar-inner">
          <div class="icons">
            <a id="prev"   class="ico" title="Previous"><span>‚óÄÔ∏è</span></a>
            <a id="rand"   class="ico" title="Random"><span>üé≤</span></a>
            <a id="leadMap" class="ico" title="Lead Map" target="_blank" rel="noopener"><span>üó∫Ô∏è</span></a>
            <a id="reload" class="ico" title="Reload"><span>‚ü≥</span></a>
          </div>
          <button id="next" class="cta">Next Deal</button>
          <div class="icons">
            <a id="call"   class="ico" title="Call"><span>üìû</span></a>
            <a id="sms"    class="ico" title="SMS"><span>üí¨</span></a>
            <a id="email"  class="ico" title="Email"><span>‚úâÔ∏è</span></a>
            <a id="notes"  class="ico" title="Update Notes" target="_blank" rel="noopener"><span>üìù</span></a>
            <a id="copy"   class="ico" title="Copy Phone"><span>üìã</span></a>
          </div>
        </div>
      </div>

      <div class="pad">
        <div id="leadCard" class="lead"><div class="body">Initializing‚Ä¶</div></div>
      </div>
    </section>
  </div>

  <!-- Cache-busted leads.js -->
  <script>
    (function(){
      const s=document.createElement('script');
      s.src='/leads.js?v='+Date.now();
      s.onload=()=>{ window.leads=window.leads||[]; init(); };
      s.onerror=()=>{ document.getElementById('status').textContent='Could not load /leads.js'; };
      document.head.appendChild(s);
    })();
  </script>

  <script>
    const $=q=>document.querySelector(q);
    let i=0;
    const uid = new URL(location.href).searchParams.get('uid')||'anon';
    const phoneOf = l => (l?.contacts?.[0]?.phone||'').trim();
    const nameOf  = l => (l?.contacts?.[0]?.name || 'Unknown').trim();
    const setStatus=t=>{const el=$('#status'); if(el) el.textContent=t;}

    function render(n){
      if(!Array.isArray(window.leads)||!window.leads.length){
        setStatus('No leads found.'); $('#leadCard').innerHTML='<div class="body">No leads loaded.</div>'; return;
      }
      if(n<0) n=window.leads.length-1; if(n>=window.leads.length) n=0; i=n;
      const lead  = window.leads[i];
      const name  = nameOf(lead);
      const phone = phoneOf(lead);
      const addr  = lead?.address || '';
      const notes = (lead?.notes||'').replace(/\n/g,'<br>');
      setStatus(`Lead ${i+1} of ${window.leads.length}`);

      // toolbar links
      $('#call').href  = phone?`tel:${phone}`:'#';
      $('#sms').href   = phone?`sms:${phone}`:'#';
      $('#email').href = `mailto:?subject=${encodeURIComponent(name)} ‚Äî Lead`;
      $('#notes').href = `https://docs.google.com/forms/d/e/1FAIpQLScIZ7GX_ga5yOx34817gOL8Bb5m3KFXW8r-5I4taw_-ergOxw/viewform?usp=pp_url&entry.849181096=${encodeURIComponent('Wholesaler')}&entry.121126280=${encodeURIComponent(name)}&entry.1828741519=${encodeURIComponent(addr)}`;
      $('#leadMap').href='https://www.google.com/maps/d/u/0/viewer?mid=1C_OfzvCIlHnx-6nLaZ3Y88izZtflM5g&hl=en';

      // card
      $('#leadCard').innerHTML = `
        <div class="ttl">${addr || name}</div>
        <div class="body">
          <div class="name">${name}</div>
          <details open>
            <summary>üìä Deal Details</summary>
            <div style="padding:8px 12px">${notes || 'No deal notes available.'}</div>
          </details>
          <iframe class="map" src="https://www.google.com/maps?q=${encodeURIComponent(addr)}&output=embed" loading="lazy"></iframe>
          <div class="chips">
            <div class="chip">UID: ${uid.slice(0,8)}</div>
            <div class="chip">${phone ? 'Phone on file' : 'Phone missing'}</div>
            <a class="chip" href="https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(addr)}" target="_blank" rel="noopener">Directions</a>
            <a class="chip" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(addr)}" target="_blank" rel="noopener">Open in Google Maps</a>
          </div>
        </div>`;
    }

    // simple controls
    $('#next').onclick = ()=>render(i+1);
    $('#prev').onclick = ()=>render(i-1);
    $('#rand').onclick = ()=>render(Math.floor(Math.random()*(window.leads?.length||1)));
    $('#copy').onclick = ()=>{
      const p=phoneOf(window.leads?.[i]); if(!p) return alert('No phone on this lead.');
      navigator.clipboard.writeText(p).then(()=>alert('Copied: '+p));
    };
    $('#reload').onclick=()=>location.reload();

    document.addEventListener('keydown',e=>{
      if(e.key==='ArrowLeft') return $('#prev').click();
      if(e.key==='ArrowRight')return $('#next').click();
      if(e.key.toLowerCase()==='r') return $('#rand').click();
      if(e.key.toLowerCase()==='c') return $('#copy').click();
    });

    function init(){ if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>render(0));} else {render(0);} }
  </script>
</body>
</html>
