<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Acquisition ‚Ä¢ DealBankers</title>
  <link rel="icon" type="image/jpeg" href="icon (1).jpg"/>

  <style>
    :root{
      --bg1:#0b131b; --bg2:#142838; --bg3:#173c53;
      --text:#f3f8fb; --muted:#c7d7e6;
      --line:rgba(255,255,255,.22);
      --accent:#5de0ff; --accent2:#ffd36b; --green:#2dd07f;
      --shadow:0 22px 60px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--text);
      font-family:"Segoe UI",system-ui,-apple-system,Arial,sans-serif;
      background:
        radial-gradient(1000px 420px at 92% -12%, rgba(93,224,255,.25) 0%, transparent 60%),
        linear-gradient(135deg,var(--bg1),var(--bg2) 55%,var(--bg3));
      padding:8px 8px 12px;
    }
    .wrap{max-width:1100px;margin:0 auto}
    .card{border:1px solid var(--line);border-radius:18px;box-shadow:var(--shadow);overflow:hidden;
      background:linear-gradient(180deg,rgba(255,255,255,.12),rgba(255,255,255,.06))}
    .top{
      display:flex;align-items:center;justify-content:space-between;
      padding:8px 10px;border-bottom:1px solid var(--line);
      background:linear-gradient(180deg,rgba(255,255,255,.16),rgba(255,255,255,.06));
    }
    .crumbs{display:flex;gap:8px;align-items:center;font-size:12px;color:var(--muted)}
    .dot{width:7px;height:7px;border-radius:999px;background:var(--accent);box-shadow:0 0 16px rgba(93,224,255,.95)}
    .status{font-size:12px;color:#e7f6ff}

    /* Compact sticky actions */
    .sticky{position:sticky;top:0;z-index:8;padding:8px;border-bottom:1px solid var(--line);
      background:linear-gradient(180deg,rgba(0,0,0,.18),rgba(255,255,255,.06))}
    .actions{display:grid;gap:8px}
    .actions.main{grid-template-columns:repeat(6,1fr)}
    .actions.util{grid-template-columns:repeat(5,1fr)}

    .btn{
      display:flex;align-items:center;justify-content:center;gap:8px;
      padding:10px 12px;border-radius:12px;border:1px solid var(--line);
      background:#0f2a3a;color:#eaf6ff;font-weight:800;letter-spacing:.02em;
      cursor:pointer; text-decoration:none; box-shadow:0 3px 10px rgba(0,0,0,.28)
    }
    .btn b{font-weight:800}
    .b-bright{background:linear-gradient(180deg,#fff,#eaf7ff);color:#0b2030;border:none}
    .b-gold{background:linear-gradient(180deg,var(--accent2),#c89b3a);color:#1a1405;border:none}
    .b-green{background:linear-gradient(180deg,var(--green),#1b9b63);color:#fff;border:none}

    /* Lead card */
    .leadwrap{padding:10px}
    .lead{border:1px solid var(--line);border-radius:14px;overflow:hidden;
      background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.04))}
    .lead .title{padding:12px 14px;font-weight:900;letter-spacing:.03em;border-bottom:1px solid var(--line);
      background:linear-gradient(90deg, rgba(255,211,107,.22), transparent 45%)}
    .lead .body{padding:10px 12px}
    .chips{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
    .chip{font-size:12px;font-weight:700;padding:6px 10px;border-radius:999px;border:1px solid var(--line);background:#0f2c3e}
    details{background:#0e2130;border:1px solid var(--line);border-radius:12px;overflow:hidden;margin:8px 0}
    summary{cursor:pointer;padding:10px 12px;font-weight:800}
    .map{width:100%;height:210px;border:0;border-radius:12px;background:#fff;margin-top:8px}

    /* Mobile super-compact: emoji-only buttons + tighter spacing */
    @media (max-width: 480px){
      .sticky{padding:6px}
      .actions.main{grid-template-columns:repeat(6,1fr)}
      .actions.util{grid-template-columns:repeat(5,1fr)}
      .btn{padding:10px 8px;border-radius:10px;font-weight:900}
      .btn .lbl{display:none}        /* hide text, keep emoji */
      .btn .emo{font-size:18px;line-height:1}
      .map{height:190px}
      body{padding:6px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <section class="card">
      <div class="top">
        <div class="crumbs">Wholesaler <span class="dot"></span> Acquisition</div>
        <div class="status" id="status">Loading‚Ä¶</div>
      </div>

      <!-- sticky action bars -->
      <div class="sticky">
        <!-- Main actions (fit inside iframe on mobile; emoji-only) -->
        <div class="actions main">
          <a id="btnPrev"   class="btn b-bright" role="button" aria-label="Previous"><span class="emo">‚óÄÔ∏è</span><span class="lbl">Prev</span></a>
          <a id="actCall"   class="btn b-green"  role="button" aria-label="Call"><span class="emo">üìû</span><span class="lbl">Call</span></a>
          <a id="actSMS"    class="btn b-bright" role="button" aria-label="SMS"><span class="emo">üí¨</span><span class="lbl">SMS</span></a>
          <a id="actEmail"  class="btn b-gold"   role="button" aria-label="Email"><span class="emo">‚úâÔ∏è</span><span class="lbl">Email</span></a>
          <a id="actNotes"  class="btn b-bright" role="button" aria-label="Update Notes" target="_blank" rel="noopener"><span class="emo">üìù</span><span class="lbl">Update Notes</span></a>
          <a id="btnNext"   class="btn b-bright" role="button" aria-label="Next"><span class="emo">‚ñ∂Ô∏è</span><span class="lbl">Next</span></a>
        </div>

        <!-- Utility row -->
        <div class="actions util" style="margin-top:8px">
          <a id="btnRandom" class="btn b-bright" role="button" aria-label="Random"><span class="emo">üé≤</span><span class="lbl">Random</span></a>
          <a id="btnCopyPhone" class="btn b-green" role="button" aria-label="Copy Phone"><span class="emo">üìã</span><span class="lbl">Copy Phone</span></a>
          <a id="btnLeadMap" class="btn b-bright" role="button" aria-label="Lead Map"><span class="emo">üó∫Ô∏è</span><span class="lbl">Lead Map</span></a>
          <a id="btnOpenFs"  class="btn b-bright" role="button" aria-label="Fullscreen"><span class="emo">‚§¢</span><span class="lbl">Fullscreen</span></a>
          <a id="btnReload"  class="btn b-bright" role="button" aria-label="Reload"><span class="emo">‚ü≥</span><span class="lbl">Reload</span></a>
        </div>
      </div>

      <!-- lead -->
      <div class="leadwrap">
        <div id="leadCard" class="lead"><div class="body">Initializing‚Ä¶</div></div>
      </div>
    </section>
  </div>

  <!-- cache-busted leads.js -->
  <script>
    (function(){
      const s=document.createElement('script');
      s.src='/leads.js?v='+Date.now();
      s.onload=()=>{ window.leads=window.leads||[]; init(); };
      s.onerror=()=>{ document.getElementById('status').textContent='Could not load /leads.js'; };
      document.head.appendChild(s);
    })();
  </script>

  <script>
    const $=q=>document.querySelector(q);
    let idx=0;
    const uid=new URL(location.href).searchParams.get('uid')||'anon';
    const statusEl=$('#status');
    const phoneOf=l=>(l?.contacts?.[0]?.phone||'').trim();
    const setStatus=t=>statusEl.textContent=t;

    function render(i){
      if(!Array.isArray(window.leads)||!window.leads.length){
        setStatus('No leads found.'); $('#leadCard').innerHTML='<div class="body">No leads loaded.</div>'; return;
      }
      if(i<0) i=window.leads.length-1; if(i>=window.leads.length) i=0; idx=i;
      const lead=window.leads[idx];
      const name=lead?.contacts?.[0]?.name||'Unknown';
      const phone=phoneOf(lead);
      const addr=lead?.address||'';
      const notes=(lead?.notes||'').replace(/\n/g,'<br>');
      setStatus(`Lead ${idx+1} of ${window.leads.length}`);

      // top links
      $('#actCall').href  = phone?`tel:${phone}`:'#';
      $('#actSMS').href   = phone?`sms:${phone}`:'#';
      $('#actEmail').href = `mailto:?subject=${encodeURIComponent(name)} ‚Äî Lead`;
      $('#actNotes').href = `https://docs.google.com/forms/d/e/1FAIpQLScIZ7GX_ga5yOx34817gOL8Bb5m3KFXW8r-5I4taw_-ergOxw/viewform?usp=pp_url&entry.849181096=${encodeURIComponent('Wholesaler')}&entry.121126280=${encodeURIComponent(name)}&entry.1828741519=${encodeURIComponent(addr)}`;

      // card
      $('#leadCard').innerHTML=`
        <div class="title">${addr || name}</div>
        <div class="body">
          <div style="margin-bottom:6px;font-weight:800">${name}</div>
          <details open>
            <summary>üìä Deal Details</summary>
            <div style="padding:8px 12px">${notes || 'No deal notes available.'}</div>
          </details>
          <div class="chips">
            <div class="chip">UID: ${uid.slice(0,8)}</div>
            <div class="chip">${phone ? 'Phone on file' : 'Phone missing'}</div>
          </div>
          <iframe class="map" src="https://www.google.com/maps?q=${encodeURIComponent(addr)}&output=embed" loading="lazy"></iframe>
          <div class="chips" style="margin-top:8px">
            <a class="chip" href="https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(addr)}" target="_blank" rel="noopener">Directions</a>
            <a class="chip" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(addr)}" target="_blank" rel="noopener">Open in Google Maps</a>
          </div>
        </div>`;
    }

    // actions
    $('#btnPrev').onclick = ()=>render(idx-1);
    $('#btnNext').onclick = ()=>render(idx+1);
    $('#btnRandom').onclick=()=>render(Math.floor(Math.random()*(window.leads?.length||1)));
    $('#btnCopyPhone').onclick=()=>{
      const p=phoneOf(window.leads?.[idx]); if(!p) return alert('No phone on this lead.');
      navigator.clipboard.writeText(p).then(()=>alert('Copied: '+p));
    };
    $('#btnLeadMap').onclick = ()=>window.open('https://www.google.com/maps/d/u/0/viewer?mid=1C_OfzvCIlHnx-6nLaZ3Y88izZtflM5g&hl=en','_blank','noopener');
    $('#btnOpenFs').onclick  = ()=>window.open(location.href,'_blank','noopener');
    $('#btnReload').onclick  = ()=>location.reload();

    document.addEventListener('keydown',e=>{
      if(e.key==='ArrowLeft') return $('#btnPrev').click();
      if(e.key==='ArrowRight') return $('#btnNext').click();
      if(e.key.toLowerCase()==='r') return $('#btnRandom').click();
      if(e.key.toLowerCase()==='c') return $('#btnCopyPhone').click();
    });

    function init(){ if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>render(0));} else {render(0);} }
  </script>
</body>
</html>
